/*! For license information please see bundle.f6c9e594bad3ac5ce576.js.LICENSE.txt */
(()=>{var e={362:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>h});var i=n(467),r=n(29),s=n(212),o=n(756),a=n.n(o),c=n(314);const h=new(function(){return(0,s.A)((function e(){(0,r.A)(this,e),this.assets=new Map,this.loadingPromises=new Map,this.preloadQueue=new Set,this.loadedCount=0,this.totalAssets=0,this.onProgressCallback=null,this.defaultAssets={texture:"/assets/textures/default.png",model:null,sound:null}}),[{key:"preloadAssets",value:(u=(0,i.A)(a().mark((function e(t){var n,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.totalAssets=t.length,this.loadedCount=0,n=t.map(function(){var e=(0,i.A)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.loadAsset(t.path,t.type);case 3:r.loadedCount++,r.updateProgress(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),c.A.error("Failed to preload asset: ".concat(t.path),e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),e.next=5,Promise.all(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"loadAsset",value:(l=(0,i.A)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.assets.has(t)){e.next=3;break}return e.abrupt("return",this.assets.get(t));case 3:return e.next=5,this.loadAssetWithFallback(t,n);case 5:return i=e.sent,this.assets.set(t,i),e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(0),c.A.warn("Failed to load asset: ".concat(t,", using default"),e.t0),e.abrupt("return",this.getDefaultAsset(n));case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e,t){return l.apply(this,arguments)})},{key:"loadAssetWithFallback",value:(h=(0,i.A)(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:if((i=e.sent).ok){e.next=6;break}throw new Error("Failed to load asset: ".concat(t));case 6:return e.next=8,this.processAsset(i,n);case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",this.getDefaultAsset(n));case 14:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,t){return h.apply(this,arguments)})},{key:"getDefaultAsset",value:function(e){return this.defaultAssets[e]}},{key:"loadTexture",value:(o=(0,i.A)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var i=new Image;i.crossOrigin="anonymous",i.onload=function(){return e(i)},i.onerror=function(){return n(new Error("Failed to load texture: ".concat(t)))},i.src=t})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"loadModel",value:(n=(0,i.A)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new THREE.FBXLoader,e.prev=1,e.next=4,n.loadAsync(t);case 4:return e.abrupt("return",e.sent);case 7:throw e.prev=7,e.t0=e.catch(1),new Error("Failed to load model: ".concat(t));case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),function(e){return n.apply(this,arguments)})},{key:"loadSound",value:(t=(0,i.A)(a().mark((function e(t){var n,i,r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.arrayBuffer();case 6:return i=e.sent,r=new(window.AudioContext||window.webkitAudioContext),e.next=10,r.decodeAudioData(i);case 10:return s=e.sent,e.abrupt("return",s);case 14:throw e.prev=14,e.t0=e.catch(0),new Error("Failed to load sound: ".concat(t));case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))),function(e){return t.apply(this,arguments)})},{key:"loadJSON",value:(e=(0,i.A)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return n=e.sent,e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(0),new Error("Failed to load JSON: ".concat(t));case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),function(t){return e.apply(this,arguments)})},{key:"updateProgress",value:function(){if(this.onProgressCallback){var e=this.loadedCount/this.totalAssets*100;this.onProgressCallback(e)}}},{key:"setProgressCallback",value:function(e){this.onProgressCallback=e}},{key:"getAsset",value:function(e){return this.assets.get(e)}},{key:"clearCache",value:function(){this.assets.clear(),this.loadingPromises.clear(),this.preloadQueue.clear(),this.loadedCount=0,this.totalAssets=0}},{key:"dispose",value:function(){this.assets.forEach((function(e,t){e.dispose&&e.dispose()})),this.clearCache()}}]);var e,t,n,o,h,l,u}())},77:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Jf});var i=n(467),r=n(29),s=n(212),o=n(756),a=n.n(o);const c=function(e,t){if(!e)throw h(t)},h=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},l=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&e.charCodeAt(++i)),t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const r=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,h=r>>2,l=(3&r)<<4|o>>4;let u=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(u=64)),i.push(n[h],n[l],n[u],n[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(l(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,i=0;for(;n<e.length;){const r=e[n++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=e[n++];t[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const r=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==r||null==s||null==o||null==a)throw new d;const c=r<<2|s>>4;if(i.push(c),64!==o){const e=s<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class d extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const p=function(e){const t=l(e);return u.encodeByteArray(t,!0)},f=function(e){return p(e).replace(/\./g,"")},g=function(e){try{return u.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function m(e){return _(void 0,e)}function _(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=_(e[n],t[n]));return e}const y=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&g(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},v=e=>{var t,n;return null===(n=null===(t=y())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},w=e=>{const t=v(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),i]:[t.substring(0,n),i]},b=()=>{var e;return null===(e=y())||void 0===e?void 0:e.config},I=e=>{var t;return null===(t=y())||void 0===t?void 0:t[`_${e}`]};class T{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function C(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,r=e.sub||e.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},e);return[f(JSON.stringify({alg:"none",type:"JWT"})),f(JSON.stringify(s)),""].join(".")}function E(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function k(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(E())}function S(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function R(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function P(){try{return"object"==typeof indexedDB}catch(e){return!1}}function A(){return new Promise(((e,t)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),e(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var e;t((null===(e=r.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class N extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,N.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,O.prototype.create)}}class O{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],s=r?function(e,t){return e.replace(D,((e,n)=>{const i=t[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new N(i,o,n)}}const D=/\{\$([^}]+)}/g;function x(e){return JSON.parse(e)}function L(e){return JSON.stringify(e)}const M=function(e){let t={},n={},i={},r="";try{const s=e.split(".");t=x(g(s[0])||""),n=x(g(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:i,signature:r}};function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function j(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function q(e,t,n){const i={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function B(e,t){if(e===t)return!0;const n=Object.keys(e),i=Object.keys(t);for(const r of n){if(!i.includes(r))return!1;const n=e[r],s=t[r];if(H(n)&&H(s)){if(!B(n,s))return!1}else if(n!==s)return!1}for(const e of i)if(!n.includes(e))return!1;return!0}function H(e){return null!==e&&"object"==typeof e}function W(e){const t=[];for(const[n,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function z(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,i]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(i)}})),t}function V(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ${constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let i=0;i<16;i++)n[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let i,r,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(i=c^o&(a^c),r=1518500249):(i=o^a^c,r=1859775393):e<60?(i=o&a|c&(o|a),r=2400959708):(i=o^a^c,r=3395469782);const t=(s<<5|s>>>27)+i+h+r+n[e]&4294967295;h=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let i=0;const r=this.buf_;let s=this.inbuf_;for(;i<t;){if(0===s)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(r[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<t;)if(r[s]=e[i],++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let i=24;i>=0;i-=8)e[n]=this.chain_[t]>>i&255,++n;return e}}class K{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function(e){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=G),void 0===i.error&&(i.error=G),void 0===i.complete&&(i.complete=G);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(e){}})),this.observers.push(i),r}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function G(){}const Y=function(e){let t=0;for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,n++):t+=3}return t};function J(e,t=1e3,n=2){const i=t*Math.pow(n,e),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function X(e){return e&&e._delegate?e._delegate:e}class Q{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Z="[DEFAULT]";class ee{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new T;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Z})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=Z){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=Z){return this.instances.has(e)}getOptions(e=Z){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===Z?void 0:i),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var i;return n||null}normalizeInstanceIdentifier(e=Z){return this.component?this.component.multipleInstances?e:Z:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class te{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ee(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ne=[];var ie;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ie||(ie={}));const re={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},se=ie.INFO,oe={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},ae=(e,t,...n)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),r=oe[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[r](`[${i}]  ${e.name}:`,...n)};class ce{constructor(e){this.name=e,this._logLevel=se,this._logHandler=ae,this._userLogHandler=null,ne.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?re[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...e),this._logHandler(this,ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...e),this._logHandler(this,ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...e),this._logHandler(this,ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...e),this._logHandler(this,ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...e),this._logHandler(this,ie.ERROR,...e)}}let he,le;const ue=new WeakMap,de=new WeakMap,pe=new WeakMap,fe=new WeakMap,ge=new WeakMap;let me={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return de.get(e);if("objectStoreNames"===t)return e.objectStoreNames||pe.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ye(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function _e(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(le||(le=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(ve(this),e),ye(ue.get(this))}:function(...e){return ye(t.apply(ve(this),e))}:function(e,...n){const i=t.call(ve(this),e,...n);return pe.set(i,e.sort?e.sort():[e]),ye(i)}:(e instanceof IDBTransaction&&function(e){if(de.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));de.set(e,t)}(e),n=e,(he||(he=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,me):e);var t,n}function ye(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(ye(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&ue.set(t,e)})).catch((()=>{})),ge.set(t,e),t}(e);if(fe.has(e))return fe.get(e);const t=_e(e);return t!==e&&(fe.set(e,t),ge.set(t,e)),t}const ve=e=>ge.get(e),we=["get","getKey","getAll","getAllKeys","count"],be=["put","add","delete","clear"],Ie=new Map;function Te(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Ie.get(t))return Ie.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=be.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!we.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return Ie.set(t,s),s}var Ce;Ce=me,me={...Ce,get:(e,t,n)=>Te(e,t)||Ce.get(e,t,n),has:(e,t)=>!!Te(e,t)||Ce.has(e,t)};class Ee{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ke="@firebase/app",Se="0.9.13",Re=new ce("@firebase/app"),Pe="@firebase/app-compat",Ae="@firebase/analytics-compat",Ne="@firebase/analytics",Oe="@firebase/app-check-compat",De="@firebase/app-check",xe="@firebase/auth",Le="@firebase/auth-compat",Me="@firebase/database",Fe="@firebase/database-compat",Ue="@firebase/functions",je="@firebase/functions-compat",qe="@firebase/installations",Be="@firebase/installations-compat",He="@firebase/messaging",We="@firebase/messaging-compat",ze="@firebase/performance",Ve="@firebase/performance-compat",$e="@firebase/remote-config",Ke="@firebase/remote-config-compat",Ge="@firebase/storage",Ye="@firebase/storage-compat",Je="@firebase/firestore",Xe="@firebase/firestore-compat",Qe="firebase",Ze="[DEFAULT]",et={[ke]:"fire-core",[Pe]:"fire-core-compat",[Ne]:"fire-analytics",[Ae]:"fire-analytics-compat",[De]:"fire-app-check",[Oe]:"fire-app-check-compat",[xe]:"fire-auth",[Le]:"fire-auth-compat",[Me]:"fire-rtdb",[Fe]:"fire-rtdb-compat",[Ue]:"fire-fn",[je]:"fire-fn-compat",[qe]:"fire-iid",[Be]:"fire-iid-compat",[He]:"fire-fcm",[We]:"fire-fcm-compat",[ze]:"fire-perf",[Ve]:"fire-perf-compat",[$e]:"fire-rc",[Ke]:"fire-rc-compat",[Ge]:"fire-gcs",[Ye]:"fire-gcs-compat",[Je]:"fire-fst",[Xe]:"fire-fst-compat","fire-js":"fire-js",[Qe]:"fire-js-all"},tt=new Map,nt=new Map;function it(e,t){try{e.container.addComponent(t)}catch(n){Re.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function rt(e){const t=e.name;if(nt.has(t))return Re.debug(`There were multiple attempts to register component ${t}.`),!1;nt.set(t,e);for(const t of tt.values())it(t,e);return!0}function st(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const ot=new O("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class at{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Q("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ot.create("app-deleted",{appName:this._name})}}const ct="9.23.0";function ht(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const i=Object.assign({name:Ze,automaticDataCollectionEnabled:!1},t),r=i.name;if("string"!=typeof r||!r)throw ot.create("bad-app-name",{appName:String(r)});if(n||(n=b()),!n)throw ot.create("no-options");const s=tt.get(r);if(s){if(B(n,s.options)&&B(i,s.config))return s;throw ot.create("duplicate-app",{appName:r})}const o=new te(r);for(const e of nt.values())o.addComponent(e);const a=new at(n,i,o);return tt.set(r,a),a}function lt(e=Ze){const t=tt.get(e);if(!t&&e===Ze&&b())return ht();if(!t)throw ot.create("no-app",{appName:e});return t}function ut(e,t,n){var i;let r=null!==(i=et[e])&&void 0!==i?i:e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Re.warn(e.join(" "))}rt(new Q(`${r}-version`,(()=>({library:r,version:t})),"VERSION"))}const dt="firebase-heartbeat-store";let pt=null;function ft(){return pt||(pt=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=ye(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(ye(o.result),e.oldVersion,e.newVersion,ye(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(dt)}}).catch((e=>{throw ot.create("idb-open",{originalErrorMessage:e.message})}))),pt}async function gt(e,t){try{const n=(await ft()).transaction(dt,"readwrite"),i=n.objectStore(dt);await i.put(t,mt(e)),await n.done}catch(e){if(e instanceof N)Re.warn(e.message);else{const t=ot.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});Re.warn(t.message)}}}function mt(e){return`${e.name}!${e.options.appId}`}class _t{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new vt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=yt();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=yt(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let i=e.slice();for(const r of e){const e=n.find((e=>e.agent===r.agent));if(e){if(e.dates.push(r.date),wt(n)>t){e.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),wt(n)>t){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=f(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function yt(){return(new Date).toISOString().substring(0,10)}class vt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!P()&&A().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=await ft();return await t.transaction(dt).objectStore(dt).get(mt(e))}catch(e){if(e instanceof N)Re.warn(e.message);else{const t=ot.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});Re.warn(t.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return gt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return gt(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function wt(e){return f(JSON.stringify({version:2,heartbeats:e})).length}rt(new Q("platform-logger",(e=>new Ee(e)),"PRIVATE")),rt(new Q("heartbeat",(e=>new _t(e)),"PRIVATE")),ut(ke,Se,""),ut(ke,Se,"esm2017"),ut("fire-js","");const bt="@firebase/database",It="0.14.4";let Tt="";class Ct{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),L(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:x(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Et{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return F(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const kt=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Ct(t)}}catch(e){}return new Et},St=kt("localStorage"),Rt=kt("sessionStorage"),Pt=new ce("@firebase/database"),At=function(){let e=1;return function(){return e++}}(),Nt=function(e){const t=function(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);if(r>=55296&&r<=56319){const t=r-55296;i++,c(i<e.length,"Surrogate pair missing trail surrogate."),r=65536+(t<<10)+(e.charCodeAt(i)-56320)}r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):r<65536?(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128)}return t}(e),n=new $;n.update(t);const i=n.digest();return u.encodeByteArray(i)},Ot=function(...e){let t="";for(let n=0;n<e.length;n++){const i=e[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=Ot.apply(null,i):t+="object"==typeof i?L(i):i,t+=" "}return t};let Dt=null,xt=!0;const Lt=function(...e){if(!0===xt&&(xt=!1,null===Dt&&!0===Rt.get("logging_enabled")&&(t=!0,c(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Pt.logLevel=ie.VERBOSE,Dt=Pt.log.bind(Pt),n&&Rt.set("logging_enabled",!0)):"function"==typeof t?Dt=t:(Dt=null,Rt.remove("logging_enabled")))),Dt){const t=Ot.apply(null,e);Dt(t)}var t,n},Mt=function(e){return function(...t){Lt(e,...t)}},Ft=function(...e){const t="FIREBASE INTERNAL ERROR: "+Ot(...e);Pt.error(t)},Ut=function(...e){const t=`FIREBASE FATAL ERROR: ${Ot(...e)}`;throw Pt.error(t),new Error(t)},jt=function(...e){const t="FIREBASE WARNING: "+Ot(...e);Pt.warn(t)},qt=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Bt="[MIN_NAME]",Ht="[MAX_NAME]",Wt=function(e,t){if(e===t)return 0;if(e===Bt||t===Ht)return-1;if(t===Bt||e===Ht)return 1;{const n=Xt(e),i=Xt(t);return null!==n?null!==i?n-i==0?e.length-t.length:n-i:-1:null!==i?1:e<t?-1:1}},zt=function(e,t){return e===t?0:e<t?-1:1},Vt=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+L(t))},$t=function(e){if("object"!=typeof e||null===e)return L(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let i=0;i<t.length;i++)0!==i&&(n+=","),n+=L(t[i]),n+=":",n+=$t(e[t[i]]);return n+="}",n},Kt=function(e,t){const n=e.length;if(n<=t)return[e];const i=[];for(let r=0;r<n;r+=t)r+t>n?i.push(e.substring(r,n)):i.push(e.substring(r,r+t));return i};function Gt(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Yt=function(e){c(!qt(e),"Invalid JSON number");let t,n,i,r,s;0===e?(n=0,i=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=r+1023,i=Math.round(e*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,i=Math.round(e/Math.pow(2,-1074))));const o=[];for(s=52;s;s-=1)o.push(i%2?1:0),i=Math.floor(i/2);for(s=11;s;s-=1)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();const a=o.join("");let h="";for(s=0;s<64;s+=8){let e=parseInt(a.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),h+=e}return h.toLowerCase()},Jt=new RegExp("^-?(0*)\\d{1,10}$"),Xt=function(e){if(Jt.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Qt=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw jt("Exception was thrown by user callback.",t),e}),Math.floor(0))}},Zt=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class en{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){jt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class tn{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Lt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',jt(e)}}class nn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}nn.OWNER="owner";const rn="5",sn=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,on="ac",an="websocket",cn="long_polling";class hn{constructor(e,t,n,i,r=!1,s="",o=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=St.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&St.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function ln(e,t,n){let i;if(c("string"==typeof t,"typeof type must == string"),c("object"==typeof n,"typeof params must == object"),t===an)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==cn)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const r=[];return Gt(n,((e,t)=>{r.push(e+"="+t)})),i+r.join("&")}class un{constructor(){this.counters_={}}incrementCounter(e,t=1){F(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return m(this.counters_)}}const dn={},pn={};function fn(e){const t=e.toString();return dn[t]||(dn[t]=new un),dn[t]}class gn{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Qt((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const mn="start";class _n{constructor(e,t,n,i,r,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Mt(e),this.stats_=fn(t),this.urlFn=e=>(this.appCheckToken&&(e[on]=this.appCheckToken),ln(t,cn,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new gn(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new yn(((...e)=>{const[t,n,i,r,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===mn)this.id=n,this.password=i;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[mn]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=rn,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[on]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&sn.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_n.forceAllow_=!0}static forceDisallow(){_n.forceDisallow_=!0}static isAvailable(){return!(!_n.forceAllow_&&(_n.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=L(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=p(t),i=Kt(n,1840);for(let e=0;e<i.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=L(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class yn{constructor(e,t,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=At(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=yn.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){Lt("frame writing exception"),e.stack&&Lt(e.stack),Lt(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Lt("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(i),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Lt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let vn=null;"undefined"!=typeof MozWebSocket?vn=MozWebSocket:"undefined"!=typeof WebSocket&&(vn=WebSocket);class wn{constructor(e,t,n,i,r,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Mt(this.connId),this.stats_=fn(t),this.connURL=wn.connectionURL_(t,s,o,i,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,i,r){const s={};return s.v=rn,"undefined"!=typeof location&&location.hostname&&sn.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),i&&(s[on]=i),r&&(s.p=r),ln(e,an,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,St.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new vn(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){wn.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==vn&&!wn.forceDisallow_}static previouslyFailed(){return St.isInMemoryStorage||!0===St.get("previous_websocket_failure")}markConnectionHealthy(){St.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=x(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(c(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=L(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Kt(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}wn.responsesRequiredToBeHealthy=2,wn.healthyTimeout=3e4;class bn{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[_n,wn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=wn&&wn.isAvailable();let n=t&&!wn.previouslyFailed();if(e.webSocketOnly&&(t||jt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[wn];else{const e=this.transports_=[];for(const t of bn.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);bn.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}bn.globalTransportInitialized_=!1;class In{constructor(e,t,n,i,r,s,o,a,c,h){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Mt("c:"+this.id+":"),this.transportManager_=new bn(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Zt((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Vt("t",e),n=Vt("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Vt("t",e),n=Vt("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Vt("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Ft("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ft("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),rn!==n&&jt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Zt((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Zt((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(St.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Tn{put(e,t,n,i){}merge(e,t,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class Cn{constructor(e){this.allowedEvents_=e,this.listeners_={},c(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const i=this.getInitialEvent(e);i&&t.apply(n,i)}off(e,t,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let e=0;e<i.length;e++)if(i[e].callback===t&&(!n||n===i[e].context))return void i.splice(e,1)}validateEventType_(e){c(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class En extends Cn{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||k()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new En}getInitialEvent(e){return c("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class kn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Sn(){return new kn("")}function Rn(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Pn(e){return e.pieces_.length-e.pieceNum_}function An(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new kn(e.pieces_,t)}function Nn(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function On(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Dn(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new kn(t,0)}function xn(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof kn)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new kn(n,0)}function Ln(e){return e.pieceNum_>=e.pieces_.length}function Mn(e,t){const n=Rn(e),i=Rn(t);if(null===n)return t;if(n===i)return Mn(An(e),An(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Fn(e,t){if(Pn(e)!==Pn(t))return!1;for(let n=e.pieceNum_,i=t.pieceNum_;n<=e.pieces_.length;n++,i++)if(e.pieces_[n]!==t.pieces_[i])return!1;return!0}function Un(e,t){let n=e.pieceNum_,i=t.pieceNum_;if(Pn(e)>Pn(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[i])return!1;++n,++i}return!0}class jn{constructor(e,t){this.errorPrefix_=t,this.parts_=On(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=Y(this.parts_[e]);qn(this)}}function qn(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Bn(e))}function Bn(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Hn extends Cn{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Hn}getInitialEvent(e){return c("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Wn=1e3;class zn extends Tn{constructor(e,t,n,i,r,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=zn.nextPersistentConnectionId_++,this.log_=Mt("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Wn,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Hn.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&En.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const i=++this.requestNumber_,r={r:i,a:e,b:t};this.log_(L(r)),c(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const t=new T,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,i){this.initConnection_();const r=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),c(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),c(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:t,query:e,tag:n};this.listens.get(s).set(r,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+n+" for "+i);const r={p:n};e.tag&&(r.q=t._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest("q",r,(r=>{const s=r.d,o=r.s;zn.warnOnListenWarnings_(s,t),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",r),"ok"!==o&&this.removeListen_(n,i),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&F(e,"w")){const n=U(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();jt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=M(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=M(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,i=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),c(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,t)}sendUnlisten_(e,t,n,i){this.log_("Unlisten on "+e+" for "+t);const r={p:e};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,i){const r={p:t,d:n};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,(e=>{i&&setTimeout((()=>{i(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,i){this.putInternal("p",e,t,n,i)}merge(e,t,n,i){this.putInternal("m",e,t,n,i)}putInternal(e,t,n,i,r){this.initConnection_();const s={p:t,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:e,request:s,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+L(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Ft("Unrecognized action received from server: "+L(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){c(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Wn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Wn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Wn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+zn.nextConnectionId_++,r=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},h=function(e){c(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:h};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?Lt("getToken() completed but was canceled"):(Lt("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new In(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{jt(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),r))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&jt(e),a())}}}interrupt(e){Lt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Lt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],j(this.interruptReasons_)&&(this.reconnectDelay_=Wn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>$t(e))).join("$"):"default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const n=new kn(e).toString();let i;if(this.listens.has(n)){const e=this.listens.get(n);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,t){Lt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Lt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Tt.replace(/\./g,"-")]=1,k()?e["framework.cordova"]=1:R()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=En.getInstance().currentlyOnline();return j(this.interruptReasons_)&&e}}zn.nextPersistentConnectionId_=0,zn.nextConnectionId_=0;class Vn{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Vn(e,t)}}class $n{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Vn(Bt,e),i=new Vn(Bt,t);return 0!==this.compare(n,i)}minPost(){return Vn.MIN}}let Kn;class Gn extends $n{static get __EMPTY_NODE(){return Kn}static set __EMPTY_NODE(e){Kn=e}compare(e,t){return Wt(e.name,t.name)}isDefinedOn(e){throw h("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Vn.MIN}maxPost(){return new Vn(Ht,Kn)}makePost(e,t){return c("string"==typeof e,"KeyIndex indexValue must always be a string."),new Vn(e,Kn)}toString(){return".key"}}const Yn=new Gn;class Jn{constructor(e,t,n,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,i&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Xn{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:Xn.RED,this.left=null!=i?i:Qn.EMPTY_NODE,this.right=null!=r?r:Qn.EMPTY_NODE}copy(e,t,n,i,r){return new Xn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Qn.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,i;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Qn.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Xn.RED=!0,Xn.BLACK=!1;class Qn{constructor(e,t=Qn.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Qn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Xn.BLACK,null,null))}remove(e){return new Qn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Xn.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,i=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Jn(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Jn(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Jn(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Jn(this.root_,null,this.comparator_,!0,e)}}function Zn(e,t){return Wt(e.name,t.name)}function ei(e,t){return Wt(e,t)}let ti;Qn.EMPTY_NODE=new class{copy(e,t,n,i,r){return this}insert(e,t,n){return new Xn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const ni=function(e){return"number"==typeof e?"number:"+Yt(e):"string:"+e},ii=function(e){if(e.isLeafNode()){const t=e.val();c("string"==typeof t||"number"==typeof t||"object"==typeof t&&F(t,".sv"),"Priority must be a string or number.")}else c(e===ti||e.isEmpty(),"priority of unexpected type.");c(e===ti||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let ri,si,oi;class ai{constructor(e,t=ai.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,c(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ii(this.priorityNode_)}static set __childrenNodeConstructor(e){ri=e}static get __childrenNodeConstructor(){return ri}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ai(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:ai.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ln(e)?this:".priority"===Rn(e)?this.priorityNode_:ai.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:ai.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Rn(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(c(".priority"!==n||1===Pn(e),".priority must be the last token in a path"),this.updateImmediateChild(n,ai.__childrenNodeConstructor.EMPTY_NODE.updateChild(An(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ni(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Yt(this.value_):this.value_,this.lazyHash_=Nt(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ai.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ai.__childrenNodeConstructor?-1:(c(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,i=ai.VALUE_TYPE_ORDER.indexOf(t),r=ai.VALUE_TYPE_ORDER.indexOf(n);return c(i>=0,"Unknown leaf type: "+t),c(r>=0,"Unknown leaf type: "+n),i===r?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}ai.VALUE_TYPE_ORDER=["object","boolean","number","string"];const ci=new class extends $n{compare(e,t){const n=e.node.getPriority(),i=t.node.getPriority(),r=n.compareTo(i);return 0===r?Wt(e.name,t.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Vn.MIN}maxPost(){return new Vn(Ht,new ai("[PRIORITY-POST]",oi))}makePost(e,t){const n=si(e);return new Vn(t,new ai("[PRIORITY-POST]",n))}toString(){return".priority"}},hi=Math.log(2);class li{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/hi,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ui=function(e,t,n,i){e.sort(t);const r=function(t,i){const s=i-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Xn(a,o.node,Xn.BLACK,null,null);{const c=parseInt(s/2,10)+t,h=r(t,c),l=r(c+1,i);return o=e[c],a=n?n(o):o,new Xn(a,o.node,Xn.BLACK,h,l)}},s=function(t){let i=null,s=null,o=e.length;const a=function(t,i){const s=o-t,a=o;o-=t;const h=r(s+1,a),l=e[s],u=n?n(l):l;c(new Xn(u,l.node,i,null,h))},c=function(e){i?(i.left=e,i=e):(s=e,i=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));n?a(i,Xn.BLACK):(a(i,Xn.BLACK),a(i,Xn.RED))}return s}(new li(e.length));return new Qn(i||t,s)};let di;const pi={};class fi{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return c(pi&&ci,"ChildrenNode.ts has not been loaded"),di=di||new fi({".priority":pi},{".priority":ci}),di}get(e){const t=U(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Qn?t:null}hasIndex(e){return F(this.indexSet_,e.toString())}addIndex(e,t){c(e!==Yn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const r=t.getIterator(Vn.Wrap);let s,o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),n.push(o),o=r.getNext();s=i?ui(n,e.getCompare()):pi;const a=e.toString(),h=Object.assign({},this.indexSet_);h[a]=e;const l=Object.assign({},this.indexes_);return l[a]=s,new fi(l,h)}addToIndexes(e,t){const n=q(this.indexes_,((n,i)=>{const r=U(this.indexSet_,i);if(c(r,"Missing index implementation for "+i),n===pi){if(r.isDefinedOn(e.node)){const n=[],i=t.getIterator(Vn.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&n.push(s),s=i.getNext();return n.push(e),ui(n,r.getCompare())}return pi}{const i=t.get(e.name);let r=n;return i&&(r=r.remove(new Vn(e.name,i))),r.insert(e,e.node)}}));return new fi(n,this.indexSet_)}removeFromIndexes(e,t){const n=q(this.indexes_,(n=>{if(n===pi)return n;{const i=t.get(e.name);return i?n.remove(new Vn(e.name,i)):n}}));return new fi(n,this.indexSet_)}}let gi;class mi{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&ii(this.priorityNode_),this.children_.isEmpty()&&c(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return gi||(gi=new mi(new Qn(ei),null,fi.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||gi}updatePriority(e){return this.children_.isEmpty()?this:new mi(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?gi:t}}getChild(e){const t=Rn(e);return null===t?this:this.getImmediateChild(t).getChild(An(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(c(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Vn(e,t);let i,r;t.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(n,this.children_));const s=i.isEmpty()?gi:this.priorityNode_;return new mi(i,s,r)}}updateChild(e,t){const n=Rn(e);if(null===n)return t;{c(".priority"!==Rn(e)||1===Pn(e),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(An(e),t);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,i=0,r=!0;if(this.forEachChild(ci,((s,o)=>{t[s]=o.val(e),n++,r&&mi.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):r=!1})),!e&&r&&i<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+ni(this.getPriority().val())+":"),this.forEachChild(ci,((t,n)=>{const i=n.hash();""!==i&&(e+=":"+t+":"+i)})),this.lazyHash_=""===e?"":Nt(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new Vn(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Vn(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Vn(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Vn.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Vn.Wrap);let i=n.peek();for(;null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===_i?-1:0}withIndex(e){if(e===Yn||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new mi(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Yn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(ci),n=t.getIterator(ci);let i=e.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=e.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(e){return e===Yn?null:this.indexMap_.get(e.toString())}}mi.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const _i=new class extends mi{constructor(){super(new Qn(ei),mi.EMPTY_NODE,fi.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return mi.EMPTY_NODE}isEmpty(){return!1}};function yi(e,t=null){if(null===e)return mi.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),c(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new ai(e,yi(t));if(e instanceof Array){let n=mi.EMPTY_NODE;return Gt(e,((t,i)=>{if(F(e,t)&&"."!==t.substring(0,1)){const e=yi(i);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(yi(t))}{const n=[];let i=!1;if(Gt(e,((e,t)=>{if("."!==e.substring(0,1)){const r=yi(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new Vn(e,r)))}})),0===n.length)return mi.EMPTY_NODE;const r=ui(n,Zn,(e=>e.name),ei);if(i){const e=ui(n,ci.getCompare());return new mi(r,yi(t),new fi({".priority":e},{".priority":ci}))}return new mi(r,yi(t),fi.Default)}}Object.defineProperties(Vn,{MIN:{value:new Vn(Bt,mi.EMPTY_NODE)},MAX:{value:new Vn(Ht,_i)}}),Gn.__EMPTY_NODE=mi.EMPTY_NODE,ai.__childrenNodeConstructor=mi,ti=_i,oi=_i,function(e){si=e}(yi);class vi extends $n{constructor(e){super(),this.indexPath_=e,c(!Ln(e)&&".priority"!==Rn(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),i=this.extractChild(t.node),r=n.compareTo(i);return 0===r?Wt(e.name,t.name):r}makePost(e,t){const n=yi(e),i=mi.EMPTY_NODE.updateChild(this.indexPath_,n);return new Vn(t,i)}maxPost(){const e=mi.EMPTY_NODE.updateChild(this.indexPath_,_i);return new Vn(Ht,e)}toString(){return On(this.indexPath_,0).join("/")}}const wi=new class extends $n{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Wt(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Vn.MIN}maxPost(){return Vn.MAX}makePost(e,t){const n=yi(e);return new Vn(t,n)}toString(){return".value"}};function bi(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Ii{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ci}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return c(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return c(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Bt}hasEnd(){return this.endSet_}getIndexEndValue(){return c(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return c(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ht}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return c(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ci}copy(){const e=new Ii;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ti(e){const t={};if(e.isDefault())return t;let n;if(e.index_===ci?n="$priority":e.index_===wi?n="$value":e.index_===Yn?n="$key":(c(e.index_ instanceof vi,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=L(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=L(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+L(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=L(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+L(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Ci(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==ci&&(t.i=e.index_.toString()),t}class Ei extends Tn{constructor(e,t,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Mt("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(c(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const s=Ei.getListenId_(e,n),o={};this.listens_[s]=o;const a=Ti(e._queryParams);this.restRequest_(r+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(r,a,!1,n),U(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}}))}unlisten(e,t){const n=Ei.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Ti(e._queryParams),n=e._path.toString(),i=new T;return this.restRequest_(n+".json",t,((e,t)=>{let r=t;404===e&&(r=null,e=null),null===e?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))})),i.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,r])=>{i&&i.accessToken&&(t.auth=i.accessToken),r&&r.token&&(t.ac=r.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+W(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=x(o.responseText)}catch(e){jt("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&jt("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class ki{constructor(){this.rootNode_=mi.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Si(){return{value:null,children:new Map}}function Ri(e,t,n){if(Ln(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const i=Rn(t);e.children.has(i)||e.children.set(i,Si()),Ri(e.children.get(i),t=An(t),n)}}function Pi(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,i)=>{Pi(i,new kn(t.toString()+"/"+e),n)}))}class Ai{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Gt(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Ni{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Ai(e);const n=1e4+2e4*Math.random();Zt(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Gt(e,((e,i)=>{i>0&&F(this.statsToReport_,e)&&(t[e]=i,n=!0)})),n&&this.server_.reportStats(t),Zt(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Oi;function Di(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Oi||(Oi={}));class xi{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Oi.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Ln(this.path)){if(null!=this.affectedTree.value)return c(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new kn(e));return new xi(Sn(),t,this.revert)}}return c(Rn(this.path)===e,"operationForChild called for unrelated child."),new xi(An(this.path),this.affectedTree,this.revert)}}class Li{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Oi.OVERWRITE}operationForChild(e){return Ln(this.path)?new Li(this.source,Sn(),this.snap.getImmediateChild(e)):new Li(this.source,An(this.path),this.snap)}}class Mi{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Oi.MERGE}operationForChild(e){if(Ln(this.path)){const t=this.children.subtree(new kn(e));return t.isEmpty()?null:t.value?new Li(this.source,Sn(),t.value):new Mi(this.source,Sn(),t)}return c(Rn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Mi(this.source,An(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Fi{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ln(e))return this.isFullyInitialized()&&!this.filtered_;const t=Rn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function Ui(e,t,n,i,r,s){const o=i.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw h("Should only compare child_ events.");const i=new Vn(t.childName,t.snapshotNode),r=new Vn(n.childName,n.snapshotNode);return e.index_.compare(i,r)}(e,t,n))),o.forEach((n=>{const i=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);r.forEach((r=>{r.respondsTo(n.type)&&t.push(r.createEvent(i,e.query_))}))}))}function ji(e,t){return{eventCache:e,serverCache:t}}function qi(e,t,n,i){return ji(new Fi(t,n,i),e.serverCache)}function Bi(e,t,n,i){return ji(e.eventCache,new Fi(t,n,i))}function Hi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Wi(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let zi;class Vi{constructor(e,t=(()=>(zi||(zi=new Qn(zt)),zi))()){this.value=e,this.children=t}static fromObject(e){let t=new Vi(null);return Gt(e,((e,n)=>{t=t.set(new kn(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Sn(),value:this.value};if(Ln(e))return null;{const n=Rn(e),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(An(e),t);return null!=r?{path:xn(new kn(n),r.path),value:r.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Ln(e))return this;{const t=Rn(e),n=this.children.get(t);return null!==n?n.subtree(An(e)):new Vi(null)}}set(e,t){if(Ln(e))return new Vi(t,this.children);{const n=Rn(e),i=(this.children.get(n)||new Vi(null)).set(An(e),t),r=this.children.insert(n,i);return new Vi(this.value,r)}}remove(e){if(Ln(e))return this.children.isEmpty()?new Vi(null):new Vi(null,this.children);{const t=Rn(e),n=this.children.get(t);if(n){const i=n.remove(An(e));let r;return r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty()?new Vi(null):new Vi(this.value,r)}return this}}get(e){if(Ln(e))return this.value;{const t=Rn(e),n=this.children.get(t);return n?n.get(An(e)):null}}setTree(e,t){if(Ln(e))return t;{const n=Rn(e),i=(this.children.get(n)||new Vi(null)).setTree(An(e),t);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new Vi(this.value,r)}}fold(e){return this.fold_(Sn(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((i,r)=>{n[i]=r.fold_(xn(e,i),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Sn(),t)}findOnPath_(e,t,n){const i=!!this.value&&n(t,this.value);if(i)return i;if(Ln(e))return null;{const i=Rn(e),r=this.children.get(i);return r?r.findOnPath_(An(e),xn(t,i),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Sn(),t)}foreachOnPath_(e,t,n){if(Ln(e))return this;{this.value&&n(t,this.value);const i=Rn(e),r=this.children.get(i);return r?r.foreachOnPath_(An(e),xn(t,i),n):new Vi(null)}}foreach(e){this.foreach_(Sn(),e)}foreach_(e,t){this.children.inorderTraversal(((n,i)=>{i.foreach_(xn(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class $i{constructor(e){this.writeTree_=e}static empty(){return new $i(new Vi(null))}}function Ki(e,t,n){if(Ln(t))return new $i(new Vi(n));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const r=i.path;let s=i.value;const o=Mn(r,t);return s=s.updateChild(o,n),new $i(e.writeTree_.set(r,s))}{const i=new Vi(n),r=e.writeTree_.setTree(t,i);return new $i(r)}}}function Gi(e,t,n){let i=e;return Gt(n,((e,n)=>{i=Ki(i,xn(t,e),n)})),i}function Yi(e,t){if(Ln(t))return $i.empty();{const n=e.writeTree_.setTree(t,new Vi(null));return new $i(n)}}function Ji(e,t){return null!=Xi(e,t)}function Xi(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Mn(n.path,t)):null}function Qi(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ci,((e,n)=>{t.push(new Vn(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Vn(e,n.value))})),t}function Zi(e,t){if(Ln(t))return e;{const n=Xi(e,t);return new $i(null!=n?new Vi(n):e.writeTree_.subtree(t))}}function er(e){return e.writeTree_.isEmpty()}function tr(e,t){return nr(Sn(),e.writeTree_,t)}function nr(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,r)=>{".priority"===t?(c(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=nr(xn(e,t),r,n)})),n.getChild(e).isEmpty()||null===i||(n=n.updateChild(xn(e,".priority"),i)),n}}function ir(e,t){return fr(t,e)}function rr(e,t){if(e.snap)return Un(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Un(xn(e.path,n),t))return!0;return!1}function sr(e){return e.visible}function or(e,t,n){let i=$i.empty();for(let r=0;r<e.length;++r){const s=e[r];if(t(s)){const e=s.path;let t;if(s.snap)Un(n,e)?(t=Mn(n,e),i=Ki(i,t,s.snap)):Un(e,n)&&(t=Mn(e,n),i=Ki(i,Sn(),s.snap.getChild(t)));else{if(!s.children)throw h("WriteRecord should have .snap or .children");if(Un(n,e))t=Mn(n,e),i=Gi(i,t,s.children);else if(Un(e,n))if(t=Mn(e,n),Ln(t))i=Gi(i,Sn(),s.children);else{const e=U(s.children,Rn(t));if(e){const n=e.getChild(An(t));i=Ki(i,Sn(),n)}}}}}return i}function ar(e,t,n,i,r){if(i||r){const s=Zi(e.visibleWrites,t);if(!r&&er(s))return n;if(r||null!=n||Ji(s,Sn())){const s=function(e){return(e.visible||r)&&(!i||!~i.indexOf(e.writeId))&&(Un(e.path,t)||Un(t,e.path))};return tr(or(e.allWrites,s,t),n||mi.EMPTY_NODE)}return null}{const i=Xi(e.visibleWrites,t);if(null!=i)return i;{const i=Zi(e.visibleWrites,t);return er(i)?n:null!=n||Ji(i,Sn())?tr(i,n||mi.EMPTY_NODE):null}}}function cr(e,t,n,i){return ar(e.writeTree,e.treePath,t,n,i)}function hr(e,t){return function(e,t,n){let i=mi.EMPTY_NODE;const r=Xi(e.visibleWrites,t);if(r)return r.isLeafNode()||r.forEachChild(ci,((e,t)=>{i=i.updateImmediateChild(e,t)})),i;if(n){const r=Zi(e.visibleWrites,t);return n.forEachChild(ci,((e,t)=>{const n=tr(Zi(r,new kn(e)),t);i=i.updateImmediateChild(e,n)})),Qi(r).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}return Qi(Zi(e.visibleWrites,t)).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}(e.writeTree,e.treePath,t)}function lr(e,t,n,i){return function(e,t,n,i,r){c(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=xn(t,n);if(Ji(e.visibleWrites,s))return null;{const t=Zi(e.visibleWrites,s);return er(t)?r.getChild(n):tr(t,r.getChild(n))}}(e.writeTree,e.treePath,t,n,i)}function ur(e,t){return function(e,t){return Xi(e.visibleWrites,t)}(e.writeTree,xn(e.treePath,t))}function dr(e,t,n){return function(e,t,n,i){const r=xn(t,n),s=Xi(e.visibleWrites,r);return null!=s?s:i.isCompleteForChild(n)?tr(Zi(e.visibleWrites,r),i.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function pr(e,t){return fr(xn(e.treePath,t),e.writeTree)}function fr(e,t){return{treePath:e,writeTree:t}}class gr{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;c("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),c(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const s=i.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(n,bi(n,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(n,(r=n,{type:"child_removed",snapshotNode:i.oldSnap,childName:r}));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(n,function(e,t){return{type:"child_added",snapshotNode:t,childName:e}}(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw h("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(n,bi(n,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,e);var r}getChanges(){return Array.from(this.changeMap.values())}}const mr=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class _r{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Fi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return dr(this.writes_,e,t)}}getChildAfterChild(e,t,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Wi(this.viewCache_),r=function(e,t,n,i,r,s){return function(e,t,n,i,r,s,o){let a;const c=Zi(e.visibleWrites,t),h=Xi(c,Sn());if(null!=h)a=h;else{if(null==n)return[];a=tr(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let c=n.getNext();for(;c&&e.length<r;)0!==t(c,i)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,i,r,s)}(this.writes_,i,t,1,n,e);return 0===r.length?null:r[0]}}function yr(e,t,n,i,r,s){const o=t.eventCache;if(null!=ur(i,n))return t;{let a,h;if(Ln(n))if(c(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Wi(t),r=hr(i,n instanceof mi?n:mi.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),r,s)}else{const n=cr(i,Wi(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const l=Rn(n);if(".priority"===l){c(1===Pn(n),"Can't have a priority with additional path components");const r=o.getNode();h=t.serverCache.getNode();const s=lr(i,n,r,h);a=null!=s?e.filter.updatePriority(r,s):o.getNode()}else{const c=An(n);let u;if(o.isCompleteForChild(l)){h=t.serverCache.getNode();const e=lr(i,n,o.getNode(),h);u=null!=e?o.getNode().getImmediateChild(l).updateChild(c,e):o.getNode().getImmediateChild(l)}else u=dr(i,l,t.serverCache);a=null!=u?e.filter.updateChild(o.getNode(),l,u,c,r,s):o.getNode()}}return qi(t,a,o.isFullyInitialized()||Ln(n),e.filter.filtersNodes())}}function vr(e,t,n,i,r,s,o,a){const c=t.serverCache;let h;const l=o?e.filter:e.filter.getIndexedFilter();if(Ln(n))h=l.updateFullNode(c.getNode(),i,null);else if(l.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,i);h=l.updateFullNode(c.getNode(),e,null)}else{const e=Rn(n);if(!c.isCompleteForPath(n)&&Pn(n)>1)return t;const r=An(n),s=c.getNode().getImmediateChild(e).updateChild(r,i);h=".priority"===e?l.updatePriority(c.getNode(),s):l.updateChild(c.getNode(),e,s,r,mr,null)}const u=Bi(t,h,c.isFullyInitialized()||Ln(n),l.filtersNodes());return yr(e,u,n,r,new _r(r,u,s),a)}function wr(e,t,n,i,r,s,o){const a=t.eventCache;let c,h;const l=new _r(r,t,s);if(Ln(n))h=e.filter.updateFullNode(t.eventCache.getNode(),i,o),c=qi(t,h,!0,e.filter.filtersNodes());else{const r=Rn(n);if(".priority"===r)h=e.filter.updatePriority(t.eventCache.getNode(),i),c=qi(t,h,a.isFullyInitialized(),a.isFiltered());else{const s=An(n),h=a.getNode().getImmediateChild(r);let u;if(Ln(s))u=i;else{const e=l.getCompleteChild(r);u=null!=e?".priority"===Nn(s)&&e.getChild(Dn(s)).isEmpty()?e:e.updateChild(s,i):mi.EMPTY_NODE}c=h.equals(u)?t:qi(t,e.filter.updateChild(a.getNode(),r,u,s,l,o),a.isFullyInitialized(),e.filter.filtersNodes())}}return c}function br(e,t){return e.eventCache.isCompleteForChild(t)}function Ir(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Tr(e,t,n,i,r,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,h=t;c=Ln(n)?i:new Vi(null).setTree(n,i);const l=t.serverCache.getNode();return c.children.inorderTraversal(((n,i)=>{if(l.hasChild(n)){const c=Ir(0,t.serverCache.getNode().getImmediateChild(n),i);h=vr(e,h,new kn(n),c,r,s,o,a)}})),c.children.inorderTraversal(((n,i)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===i.value;if(!l.hasChild(n)&&!c){const c=Ir(0,t.serverCache.getNode().getImmediateChild(n),i);h=vr(e,h,new kn(n),c,r,s,o,a)}})),h}function Cr(e,t){const n=Wi(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ln(t)&&!n.getImmediateChild(Rn(t)).isEmpty())?n.getChild(t):null}function Er(e,t,n,i){t.type===Oi.MERGE&&null!==t.source.queryId&&(c(Wi(e.viewCache_),"We should always have a full cache before handling merges"),c(Hi(e.viewCache_),"Missing event cache, even though we have a server cache"));const r=e.viewCache_,s=function(e,t,n,i,r){const s=new gr;let o,a;if(n.type===Oi.OVERWRITE){const h=n;h.source.fromUser?o=wr(e,t,h.path,h.snap,i,r,s):(c(h.source.fromServer,"Unknown source."),a=h.source.tagged||t.serverCache.isFiltered()&&!Ln(h.path),o=vr(e,t,h.path,h.snap,i,r,a,s))}else if(n.type===Oi.MERGE){const h=n;h.source.fromUser?o=function(e,t,n,i,r,s,o){let a=t;return i.foreach(((i,c)=>{const h=xn(n,i);br(t,Rn(h))&&(a=wr(e,a,h,c,r,s,o))})),i.foreach(((i,c)=>{const h=xn(n,i);br(t,Rn(h))||(a=wr(e,a,h,c,r,s,o))})),a}(e,t,h.path,h.children,i,r,s):(c(h.source.fromServer,"Unknown source."),a=h.source.tagged||t.serverCache.isFiltered(),o=Tr(e,t,h.path,h.children,i,r,a,s))}else if(n.type===Oi.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,i,r,s){let o;if(null!=ur(i,n))return t;{const a=new _r(i,t,r),h=t.eventCache.getNode();let l;if(Ln(n)||".priority"===Rn(n)){let n;if(t.serverCache.isFullyInitialized())n=cr(i,Wi(t));else{const e=t.serverCache.getNode();c(e instanceof mi,"serverChildren would be complete if leaf node"),n=hr(i,e)}l=e.filter.updateFullNode(h,n,s)}else{const r=Rn(n);let c=dr(i,r,t.serverCache);null==c&&t.serverCache.isCompleteForChild(r)&&(c=h.getImmediateChild(r)),l=null!=c?e.filter.updateChild(h,r,c,An(n),a,s):t.eventCache.getNode().hasChild(r)?e.filter.updateChild(h,r,mi.EMPTY_NODE,An(n),a,s):h,l.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=cr(i,Wi(t)),o.isLeafNode()&&(l=e.filter.updateFullNode(l,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=ur(i,Sn()),qi(t,l,o,e.filter.filtersNodes())}}(e,t,a.path,i,r,s):function(e,t,n,i,r,s,o){if(null!=ur(r,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=i.value){if(Ln(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return vr(e,t,n,c.getNode().getChild(n),r,s,a,o);if(Ln(n)){let i=new Vi(null);return c.getNode().forEachChild(Yn,((e,t)=>{i=i.set(new kn(e),t)})),Tr(e,t,n,i,r,s,a,o)}return t}{let h=new Vi(null);return i.foreach(((e,t)=>{const i=xn(n,e);c.isCompleteForPath(i)&&(h=h.set(e,c.getNode().getChild(i)))})),Tr(e,t,n,h,r,s,a,o)}}(e,t,a.path,a.affectedTree,i,r,s)}else{if(n.type!==Oi.LISTEN_COMPLETE)throw h("Unknown operation type: "+n.type);o=function(e,t,n,i,r){const s=t.serverCache;return yr(e,Bi(t,s.getNode(),s.isFullyInitialized()||Ln(n),s.isFiltered()),n,i,mr,r)}(e,t,n.path,i,s)}const l=s.getChanges();return function(e,t,n){const i=t.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Hi(e);(n.length>0||!e.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push({type:"value",snapshotNode:Hi(t)})}}(t,o,l),{viewCache:o,changes:l}}(e.processor_,r,t,n,i);var o,a;return o=e.processor_,a=s.viewCache,c(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),c(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),c(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,function(e,t,n,i){const r=i?[i]:e.eventRegistrations_;return function(e,t,n,i){const r=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Ui(e,r,"child_removed",t,i,n),Ui(e,r,"child_added",t,i,n),Ui(e,r,"child_moved",s,i,n),Ui(e,r,"child_changed",t,i,n),Ui(e,r,"value",t,i,n),r}(e.eventGenerator_,t,n,r)}(e,s.changes,s.viewCache.eventCache.getNode(),null)}let kr,Sr;function Rr(e,t,n,i){const r=t.source.queryId;if(null!==r){const s=e.views.get(r);return c(null!=s,"SyncTree gave us an op for an invalid query."),Er(s,t,n,i)}{let r=[];for(const s of e.views.values())r=r.concat(Er(s,t,n,i));return r}}function Pr(e,t){let n=null;for(const i of e.views.values())n=n||Cr(i,t);return n}class Ar{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Vi(null),this.pendingWriteTree_={visibleWrites:$i.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Nr(e,t,n,i,r){return function(e,t,n,i,r){c(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),e.allWrites.push({path:t,snap:n,writeId:i,visible:r}),r&&(e.visibleWrites=Ki(e.visibleWrites,t,n)),e.lastWriteId=i}(e.pendingWriteTree_,t,n,i,r),r?Lr(e,new Li({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Or(e,t,n=!1){const i=function(e,t){for(let n=0;n<e.allWrites.length;n++){const i=e.allWrites[n];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));c(n>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[n];e.allWrites.splice(n,1);let r=i.visible,s=!1,o=e.allWrites.length-1;for(;r&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&rr(t,i.path)?r=!1:Un(i.path,t.path)&&(s=!0)),o--}return!!r&&(s?(function(e){e.visibleWrites=or(e.allWrites,sr,Sn()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(i.snap?e.visibleWrites=Yi(e.visibleWrites,i.path):Gt(i.children,(t=>{e.visibleWrites=Yi(e.visibleWrites,xn(i.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new Vi(null);return null!=i.snap?t=t.set(Sn(),!0):Gt(i.children,(e=>{t=t.set(new kn(e),!0)})),Lr(e,new xi(i.path,t,n))}return[]}function Dr(e,t,n){return Lr(e,new Li({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function xr(e,t,n){const i=e.pendingWriteTree_,r=e.syncPointTree_.findOnPath(t,((e,n)=>{const i=Pr(n,Mn(e,t));if(i)return i}));return ar(i,t,r,n,!0)}function Lr(e,t){return Mr(t,e.syncPointTree_,null,ir(e.pendingWriteTree_,Sn()))}function Mr(e,t,n,i){if(Ln(e.path))return Fr(e,t,n,i);{const r=t.get(Sn());null==n&&null!=r&&(n=Pr(r,Sn()));let s=[];const o=Rn(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=pr(i,o);s=s.concat(Mr(a,c,e,t))}return r&&(s=s.concat(Rr(r,e,i,n))),s}}function Fr(e,t,n,i){const r=t.get(Sn());null==n&&null!=r&&(n=Pr(r,Sn()));let s=[];return t.children.inorderTraversal(((t,r)=>{const o=n?n.getImmediateChild(t):null,a=pr(i,t),c=e.operationForChild(t);c&&(s=s.concat(Fr(c,r,o,a)))})),r&&(s=s.concat(Rr(r,e,i,n))),s}function Ur(e,t){return e.tagToQueryMap.get(t)}function jr(e){const t=e.indexOf("$");return c(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new kn(e.substr(0,t))}}function qr(e,t,n){const i=e.syncPointTree_.get(t);return c(i,"Missing sync point for query tag that we're tracking"),Rr(i,n,ir(e.pendingWriteTree_,t),null)}class Br{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Br(t)}node(){return this.node_}}class Hr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=xn(this.path_,e);return new Hr(this.syncTree_,t)}node(){return xr(this.syncTree_,this.path_)}}const Wr=function(e,t,n){return e&&"object"==typeof e?(c(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?zr(e[".sv"],t,n):"object"==typeof e[".sv"]?Vr(e[".sv"],t):void c(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},zr=function(e,t,n){if("timestamp"===e)return n.timestamp;c(!1,"Unexpected server value: "+e)},Vr=function(e,t,n){e.hasOwnProperty("increment")||c(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!=typeof i&&c(!1,"Unexpected increment value: "+i);const r=t.node();if(c(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const s=r.getValue();return"number"!=typeof s?i:s+i},$r=function(e,t,n){return Kr(e,new Br(t),n)};function Kr(e,t,n){const i=e.getPriority().val(),r=Wr(i,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const i=e,s=Wr(i.getValue(),t,n);return s!==i.getValue()||r!==i.getPriority().val()?new ai(s,yi(r)):e}{const i=e;return s=i,r!==i.getPriority().val()&&(s=s.updatePriority(new ai(r))),i.forEachChild(ci,((e,i)=>{const r=Kr(i,t.getImmediateChild(e),n);r!==i&&(s=s.updateImmediateChild(e,r))})),s}}class Gr{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Yr(e,t){let n=t instanceof kn?t:new kn(t),i=e,r=Rn(n);for(;null!==r;){const e=U(i.node.children,r)||{children:{},childCount:0};i=new Gr(r,i,e),n=An(n),r=Rn(n)}return i}function Jr(e){return e.node.value}function Xr(e,t){e.node.value=t,ns(e)}function Qr(e){return e.node.childCount>0}function Zr(e,t){Gt(e.node.children,((n,i)=>{t(new Gr(n,e,i))}))}function es(e,t,n,i){n&&!i&&t(e),Zr(e,(e=>{es(e,t,!0,i)})),n&&i&&t(e)}function ts(e){return new kn(null===e.parent?e.name:ts(e.parent)+"/"+e.name)}function ns(e){null!==e.parent&&function(e,t,n){const i=function(e){return void 0===Jr(e)&&!Qr(e)}(n),r=F(e.node.children,t);i&&r?(delete e.node.children[t],e.node.childCount--,ns(e)):i||r||(e.node.children[t]=n.node,e.node.childCount++,ns(e))}(e.parent,e.name,e)}const is=/[\[\].#$\/\u0000-\u001F\u007F]/,rs=/[\[\].#$\u0000-\u001F\u007F]/,ss=10485760,os=function(e){return"string"==typeof e&&0!==e.length&&!is.test(e)},as=function(e,t,n){const i=n instanceof kn?new jn(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Bn(i));if("function"==typeof t)throw new Error(e+"contains a function "+Bn(i)+" with contents = "+t.toString());if(qt(t))throw new Error(e+"contains "+t.toString()+" "+Bn(i));if("string"==typeof t&&t.length>ss/3&&Y(t)>ss)throw new Error(e+"contains a string greater than "+ss+" utf8 bytes "+Bn(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,r=!1;if(Gt(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(r=!0,!os(t)))throw new Error(e+" contains an invalid key ("+t+") "+Bn(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var o,a;a=t,(o=i).parts_.length>0&&(o.byteLength_+=1),o.parts_.push(a),o.byteLength_+=Y(a),qn(o),as(e,s,i),function(e){const t=e.parts_.pop();e.byteLength_-=Y(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),n&&r)throw new Error(e+' contains ".value" child '+Bn(i)+" in addition to actual children.")}},cs=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!os(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),function(e){return"string"==typeof e&&0!==e.length&&!rs.test(e)}(e)}(n))throw new Error(function(e,t){return`${e} failed: ${t} argument `}(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class hs{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ls(e,t,n){(function(e,t){let n=null;for(let i=0;i<t.length;i++){const r=t[i],s=r.getPath();null===n||Fn(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&e.eventLists_.push(n)})(e,n),function(e,t){e.recursionDepth_++;let n=!0;for(let i=0;i<e.eventLists_.length;i++){const r=e.eventLists_[i];r&&(t(r.path)?(us(e.eventLists_[i]),e.eventLists_[i]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,(e=>Un(e,t)||Un(t,e)))}function us(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const i=n.getEventRunner();Dt&&Lt("event: "+n.toString()),Qt(i)}}}class ds{constructor(e,t,n,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hs,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Si(),this.transactionQueueTree_=new Gr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ps(e,t,n){if(e.stats_=fn(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Ei(e.repoInfo_,((t,n,i,r)=>{ms(e,t,n,i,r)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>_s(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{L(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new zn(e.repoInfo_,t,((t,n,i,r)=>{ms(e,t,n,i,r)}),(t=>{_s(e,t)}),(t=>{!function(e,t){Gt(t,((t,n)=>{ys(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t){const n=t.toString();return pn[n]||(pn[n]=new Ni(e.stats_,e.server_)),pn[n]}(e.repoInfo_),e.infoData_=new ki,e.infoSyncTree_=new Ar({startListening:(t,n,i,r)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Dr(e.infoSyncTree_,t._path,o),setTimeout((()=>{r("ok")}),0)),s},stopListening:()=>{}}),ys(e,"connected",!1),e.serverSyncTree_=new Ar({startListening:(t,n,i,r)=>(e.server_.listen(t,i,n,((n,i)=>{const s=r(n,i);ls(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function fs(e){const t=e.infoData_.getNode(new kn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function gs(e){return(t=(t={timestamp:fs(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function ms(e,t,n,i,r){e.dataUpdateCount++;const s=new kn(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(r)if(i){const t=q(n,(e=>yi(e)));o=function(e,t,n,i){const r=Ur(e,i);if(r){const i=jr(r),s=i.path,o=i.queryId,a=Mn(s,t),c=Vi.fromObject(n);return qr(e,s,new Mi(Di(o),a,c))}return[]}(e.serverSyncTree_,s,t,r)}else{const t=yi(n);o=function(e,t,n,i){const r=Ur(e,i);if(null!=r){const i=jr(r),s=i.path,o=i.queryId,a=Mn(s,t);return qr(e,s,new Li(Di(o),a,n))}return[]}(e.serverSyncTree_,s,t,r)}else if(i){const t=q(n,(e=>yi(e)));o=function(e,t,n){const i=Vi.fromObject(n);return Lr(e,new Mi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,s,t)}else{const t=yi(n);o=Dr(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=Ts(e,s)),ls(e.eventQueue_,a,o)}function _s(e,t){ys(e,"connected",t),!1===t&&function(e){ws(e,"onDisconnectEvents");const t=gs(e),n=Si();Pi(e.onDisconnect_,Sn(),((i,r)=>{const s=function(e,t,n,i){return Kr(t,new Hr(n,e),i)}(i,r,e.serverSyncTree_,t);Ri(n,i,s)}));let i=[];Pi(n,Sn(),((t,n)=>{i=i.concat(Dr(e.serverSyncTree_,t,n));const r=function(e,t){const n=ts(Cs(e,t)),i=Yr(e.transactionQueueTree_,t);return function(e,t){let n=void 0?e:e.parent;for(;null!==n;){if(t(n))return!0;n=n.parent}}(i,(t=>{Rs(e,t)})),Rs(e,i),es(i,(t=>{Rs(e,t)})),n}(e,t);Ts(e,r)})),e.onDisconnect_=Si(),ls(e.eventQueue_,Sn(),i)}(e)}function ys(e,t,n){const i=new kn("/.info/"+t),r=yi(n);e.infoData_.updateSnapshot(i,r);const s=Dr(e.infoSyncTree_,i,r);ls(e.eventQueue_,i,s)}function vs(e){return e.nextWriteId_++}function ws(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Lt(n,...t)}function bs(e,t,n){return xr(e.serverSyncTree_,t,n)||mi.EMPTY_NODE}function Is(e,t=e.transactionQueueTree_){if(t||Ss(e,t),Jr(t)){const n=Es(e,t);c(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const i=n.map((e=>e.currentWriteId)),r=bs(e,t,i);let s=r;const o=r.hash();for(let e=0;e<n.length;e++){const i=n[e];c(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const r=Mn(t,i.path);s=s.updateChild(r,i.currentOutputSnapshotRaw)}const a=s.val(!0),h=t;e.server_.put(h.toString(),a,(i=>{ws(e,"transaction put response",{path:h.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let t=0;t<n.length;t++)n[t].status=2,r=r.concat(Or(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&i.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();Ss(e,Yr(e.transactionQueueTree_,t)),Is(e,e.transactionQueueTree_),ls(e.eventQueue_,t,r);for(let e=0;e<i.length;e++)Qt(i[e])}else{if("datastale"===i)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{jt("transaction at "+h.toString()+" failed: "+i);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=i}Ts(e,t)}}),o)}(e,ts(t),n)}else Qr(t)&&Zr(t,(t=>{Is(e,t)}))}function Ts(e,t){const n=Cs(e,t),i=ts(n);return function(e,t,n){if(0===t.length)return;const i=[];let r=[];const s=t.filter((e=>0===e.status)),o=s.map((e=>e.currentWriteId));for(let s=0;s<t.length;s++){const h=t[s],l=Mn(n,h.path);let u,d=!1;if(c(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===h.status)d=!0,u=h.abortReason,r=r.concat(Or(e.serverSyncTree_,h.currentWriteId,!0));else if(0===h.status)if(h.retryCount>=25)d=!0,u="maxretry",r=r.concat(Or(e.serverSyncTree_,h.currentWriteId,!0));else{const n=bs(e,h.path,o);h.currentInputSnapshot=n;const i=t[s].update(n.val());if(void 0!==i){as("transaction failed: Data returned ",i,h.path);let t=yi(i);"object"==typeof i&&null!=i&&F(i,".priority")||(t=t.updatePriority(n.getPriority()));const s=h.currentWriteId,a=gs(e),c=$r(t,n,a);h.currentOutputSnapshotRaw=t,h.currentOutputSnapshotResolved=c,h.currentWriteId=vs(e),o.splice(o.indexOf(s),1),r=r.concat(Nr(e.serverSyncTree_,h.path,c,h.currentWriteId,h.applyLocally)),r=r.concat(Or(e.serverSyncTree_,s,!0))}else d=!0,u="nodata",r=r.concat(Or(e.serverSyncTree_,h.currentWriteId,!0))}ls(e.eventQueue_,n,r),r=[],d&&(t[s].status=2,a=t[s].unwatcher,setTimeout(a,Math.floor(0)),t[s].onComplete&&("nodata"===u?i.push((()=>t[s].onComplete(null,!1,t[s].currentInputSnapshot))):i.push((()=>t[s].onComplete(new Error(u),!1,null)))))}var a;Ss(e,e.transactionQueueTree_);for(let e=0;e<i.length;e++)Qt(i[e]);Is(e,e.transactionQueueTree_)}(e,Es(e,n),i),i}function Cs(e,t){let n,i=e.transactionQueueTree_;for(n=Rn(t);null!==n&&void 0===Jr(i);)i=Yr(i,n),n=Rn(t=An(t));return i}function Es(e,t){const n=[];return ks(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function ks(e,t,n){const i=Jr(t);if(i)for(let e=0;e<i.length;e++)n.push(i[e]);Zr(t,(t=>{ks(e,t,n)}))}function Ss(e,t){const n=Jr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Xr(t,n.length>0?n:void 0)}Zr(t,(t=>{Ss(e,t)}))}function Rs(e,t){const n=Jr(t);if(n){const i=[];let r=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(c(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(c(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),r=r.concat(Or(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&i.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Xr(t,void 0):n.length=s+1,ls(e.eventQueue_,ts(t),r);for(let e=0;e<i.length;e++)Qt(i[e])}}const Ps=function(e,t){const n=As(e),i=n.namespace;"firebase.com"===n.domain&&Ut(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||Ut("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&jt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new hn(n.host,n.secure,i,r,t,"",i!==n.subdomain),path:new kn(n.pathString)}},As=function(e){let t="",n="",i="",r="",s="",o=!0,a="https",c=443;if("string"==typeof e){let h=e.indexOf("//");h>=0&&(a=e.substring(0,h-1),e=e.substring(h+2));let l=e.indexOf("/");-1===l&&(l=e.length);let u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(l,u)),l<u&&(r=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let i=n[e];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(l,u)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):jt(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,u)));h=t.indexOf(":"),h>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(h+1),10)):h=t.length;const p=t.slice(0,h);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=i}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};class Ns{constructor(e,t,n,i){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=i}get key(){return Ln(this._path)?null:Nn(this._path)}get ref(){return new Os(this._repo,this._path)}get _queryIdentifier(){const e=Ci(this._queryParams),t=$t(e);return"{}"===t?"default":t}get _queryObject(){return Ci(this._queryParams)}isEqual(e){if(!((e=X(e))instanceof Ns))return!1;const t=this._repo===e._repo,n=Fn(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class Os extends Ns{constructor(e,t){super(e,t,new Ii,!1)}get parent(){const e=Dn(this._path);return null===e?null:new Os(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}!function(e){c(!kr,"__referenceConstructor has already been defined"),kr=e}(Os),function(e){c(!Sr,"__referenceConstructor has already been defined"),Sr=e}(Os);const Ds={};class xs{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ps(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Os(this._repo,Sn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=Ds[t];n&&n[e.key]===e||Ut(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Ut("Cannot call "+e+" on a deleted database.")}}function Ls(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}zn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},zn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},Tt=ct,rt(new Q("database",((e,{instanceIdentifier:t})=>function(e,t,n,i,r){let s=i||e.options.databaseURL;void 0===s&&(e.options.projectId||Ut("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Lt("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=Ps(s,r),h=c.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${h.namespace}`,c=Ps(s,r),h=c.repoInfo):o=!c.repoInfo.secure;const l=r&&o?new nn(nn.OWNER):new tn(e.name,e.options,t);cs("Invalid Firebase Database URL",c),Ln(c.path)||Ut("Database URL must point to the root of a Firebase Database (not including a child path).");const u=function(e,t,n,i){let r=Ds[t.name];r||(r={},Ds[t.name]=r);let s=r[e.toURLString()];return s&&Ut("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ds(e,!1,n,i),r[e.toURLString()]=s,s}(h,e,l,new en(e.name,n));return new xs(u,e)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),ut(bt,It,void 0),ut(bt,It,"esm2017"),ut("firebase","9.23.0","app"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Ms=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Fs=new O("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Us=new ce("@firebase/auth");function js(e,...t){Us.logLevel<=ie.ERROR&&Us.error(`Auth (${ct}): ${e}`,...t)}function qs(e,...t){throw Hs(e,...t)}function Bs(e,...t){return Hs(e,...t)}function Hs(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return Fs.create(e,...t)}function Ws(e,t,...n){if(!e)throw Hs(t,...n)}function zs(e){const t="INTERNAL ASSERTION FAILED: "+e;throw js(t),new Error(t)}function Vs(e,t){e||zs(t)}function $s(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ks(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Gs{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vs(t>e,"Short delay should be less than long delay!"),this.isMobile=k()||R()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Ks()||"https:"===Ks()||S()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Ys(e,t){Vs(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Js{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void zs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void zs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void zs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Xs={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Qs=new Gs(3e4,6e4);function Zs(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function eo(e,t,n,i,r={}){return to(e,r,(async()=>{let r={},s={};i&&("GET"===t?s=i:r={body:JSON.stringify(i)});const o=W(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Js.fetch()(io(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},r))}))}async function to(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},Xs),t);try{const t=new ro(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw so(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw so(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw so(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw so(e,"user-disabled",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw function(e,t,n){const i=Object.assign(Object.assign({},Ms()),{[t]:n});return new O("auth","Firebase",i).create(t,{appName:e.name})}(e,a,o);qs(e,a)}}catch(t){if(t instanceof N)throw t;qs(e,"network-request-failed",{message:String(t)})}}async function no(e,t,n,i,r={}){const s=await eo(e,t,n,i,r);return"mfaPendingCredential"in s&&qs(e,"multi-factor-auth-required",{_serverResponse:s}),s}function io(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?Ys(e.config,r):`${e.config.apiScheme}://${r}`}class ro{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Bs(this.auth,"network-request-failed"))),Qs.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function so(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=Bs(e,t,i);return r.customData._tokenResponse=n,r}function oo(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function ao(e){return 1e3*Number(e)}function co(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return js("JWT malformed, contained fewer than 3 sections"),null;try{const e=g(n);return e?JSON.parse(e):(js("Failed to decode base64 JWT payload"),null)}catch(e){return js("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function ho(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof N&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class lo{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class uo{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=oo(this.lastLoginAt),this.creationTime=oo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function po(e){var t;const n=e.auth,i=await e.getIdToken(),r=await ho(e,async function(e,t){return eo(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:i}));Ws(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Ls(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,h=o,[...c.filter((e=>!h.some((t=>t.providerId===e.providerId)))),...h]);var c,h;const l=e.isAnonymous,u=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&u,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new uo(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,p)}class fo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ws(e.idToken,"internal-error"),Ws(void 0!==e.idToken,"internal-error"),Ws(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=co(e);return Ws(t,"internal-error"),Ws(void 0!==t.exp,"internal-error"),Ws(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Ws(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await async function(e,t){const n=await to(e,{},(async()=>{const n=W({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:r}=e.config,s=io(e,i,"/v1/token",`key=${r}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Js.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new fo;return n&&(Ws("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(Ws("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(Ws("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fo,this.toJSON())}_performRefresh(){return zs("not implemented")}}function go(e,t){Ws("string"==typeof e||void 0===e,"internal-error",{appName:t})}class mo{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,r=Ls(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lo(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new uo(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await ho(this,this.stsTokenManager.getToken(this.auth,e));return Ws(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=X(e),i=await n.getIdToken(t),r=co(i);Ws(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:oo(ao(r.auth_time)),issuedAtTime:oo(ao(r.iat)),expirationTime:oo(ao(r.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=X(e);await po(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Ws(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new mo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ws(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await po(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ho(this,async function(e,t){return eo(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,h;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,u=null!==(i=t.email)&&void 0!==i?i:void 0,d=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,_=null!==(h=t.lastLoginAt)&&void 0!==h?h:void 0,{uid:y,emailVerified:v,isAnonymous:w,providerData:b,stsTokenManager:I}=t;Ws(y&&I,e,"internal-error");const T=fo.fromJSON(this.name,I);Ws("string"==typeof y,e,"internal-error"),go(l,e.name),go(u,e.name),Ws("boolean"==typeof v,e,"internal-error"),Ws("boolean"==typeof w,e,"internal-error"),go(d,e.name),go(p,e.name),go(f,e.name),go(g,e.name),go(m,e.name),go(_,e.name);const C=new mo({uid:y,auth:e,email:u,emailVerified:v,displayName:l,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:T,createdAt:m,lastLoginAt:_});return b&&Array.isArray(b)&&(C.providerData=b.map((e=>Object.assign({},e)))),g&&(C._redirectEventId=g),C}static async _fromIdTokenResponse(e,t,n=!1){const i=new fo;i.updateFromServerResponse(t);const r=new mo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await po(r),r}}const _o=new Map;function yo(e){Vs(e instanceof Function,"Expected a class definition");let t=_o.get(e);return t?(Vs(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,_o.set(e,t),t)}class vo{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vo.type="NONE";const wo=vo;function bo(e,t,n){return`firebase:${e}:${t}:${n}`}class Io{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=bo(this.userKey,i.apiKey,r),this.fullPersistenceKey=bo("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?mo._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Io(yo(wo),e,n);const i=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let r=i[0]||yo(wo);const s=bo(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const i=mo._fromJSON(e,t);n!==r&&(o=i),r=n;break}}catch(e){}const a=i.filter((e=>e._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new Io(r,e,n)):new Io(r,e,n)}}function To(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(So(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Co(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Po(t))return"Blackberry";if(Ao(t))return"Webos";if(Eo(t))return"Safari";if((t.includes("chrome/")||ko(t))&&!t.includes("edge/"))return"Chrome";if(Ro(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Co(e=E()){return/firefox\//i.test(e)}function Eo(e=E()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ko(e=E()){return/crios\//i.test(e)}function So(e=E()){return/iemobile/i.test(e)}function Ro(e=E()){return/android/i.test(e)}function Po(e=E()){return/blackberry/i.test(e)}function Ao(e=E()){return/webos/i.test(e)}function No(e=E()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Oo(e=E()){return No(e)||Ro(e)||Ao(e)||Po(e)||/windows phone/i.test(e)||So(e)}function Do(e,t=[]){let n;switch(e){case"Browser":n=To(E());break;case"Worker":n=`${To(E())}-${e}`;break;default:n=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${ct}/${i}`}async function xo(e,t){return eo(e,"GET","/v2/recaptchaConfig",Zs(e,t))}function Lo(e){return void 0!==e&&void 0!==e.enterprise}class Mo{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}function Fo(e){return new Promise(((t,n)=>{const i=document.createElement("script");var r,s;i.setAttribute("src",e),i.onload=t,i.onerror=e=>{const t=Bs("internal-error");t.customData=e,n(t)},i.type="text/javascript",i.charset="UTF-8",(null!==(s=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==s?s:document).appendChild(i)}))}function Uo(e){return`__${e}${Math.floor(1e6*Math.random())}`}class jo{constructor(e){this.type="recaptcha-enterprise",this.auth=Wo(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;Lo(r)?r.enterprise.ready((()=>{r.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{xo(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new Mo(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((r=>{if(!t&&Lo(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));Fo("https://www.google.com/recaptcha/enterprise.js?render="+r).then((()=>{n(r,e,i)})).catch((e=>{i(e)}))}})).catch((e=>{i(e)}))}))}}async function qo(e,t,n,i=!1){const r=new jo(e);let s;try{s=await r.verify(n)}catch(e){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}class Bo{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,i)=>{try{n(e(t))}catch(e){i(e)}}));n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class Ho{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zo(this),this.idTokenSubscription=new zo(this),this.beforeStateQueue=new Bo(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Fs,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=yo(t)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Io.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ws(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await po(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?X(e):null;return t&&Ws(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ws(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(yo(e))}))}async initializeRecaptchaConfig(){const e=await xo(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Mo(e);null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled&&new jo(this).verify()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new O("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&yo(e)||this._popupRedirectResolver;Ws(t,this,"argument-error"),this.redirectPersistenceManager=await Io.create(this,[yo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Ws(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ws(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Do(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Us.logLevel<=ie.WARN&&Us.warn(`Auth (${ct}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Wo(e){return X(e)}class zo{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e){const t=new K(e,void 0);return t.subscribe.bind(t)}((e=>this.observer=e))}get next(){return Ws(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Vo(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function $o(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Ko{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return zs("not implemented")}_getIdTokenResponse(e){return zs("not implemented")}_linkToIdToken(e,t){return zs("not implemented")}_getReauthenticationResolver(e){return zs("not implemented")}}async function Go(e,t){return no(e,"POST","/v1/accounts:signInWithPassword",Zs(e,t))}class Yo extends Ko{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Yo(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Yo(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await qo(e,n,"signInWithPassword");return Go(e,t)}return Go(e,n).catch((async t=>{if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await qo(e,n,"signInWithPassword");return Go(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return no(e,"POST","/v1/accounts:signInWithEmailLink",Zs(e,t))}(e,{email:this._email,oobCode:this._password});default:qs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return eo(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return no(e,"POST","/v1/accounts:signInWithEmailLink",Zs(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:qs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jo(e,t){return no(e,"POST","/v1/accounts:signInWithIdp",Zs(e,t))}class Xo extends Ko{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Xo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,r=Ls(t,["providerId","signInMethod"]);if(!n||!i)return null;const s=new Xo(n,i);return s.idToken=r.idToken||void 0,s.accessToken=r.accessToken||void 0,s.secret=r.secret,s.nonce=r.nonce,s.pendingToken=r.pendingToken||null,s}_getIdTokenResponse(e){return Jo(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Jo(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jo(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=W(t)}return e}}const Qo={USER_NOT_FOUND:"user-not-found"};class Zo extends Ko{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Zo({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Zo({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return no(e,"POST","/v1/accounts:signInWithPhoneNumber",Zs(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await no(e,"POST","/v1/accounts:signInWithPhoneNumber",Zs(e,t));if(n.temporaryProof)throw so(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return no(e,"POST","/v1/accounts:signInWithPhoneNumber",Zs(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Qo)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Zo({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class ea{constructor(e){var t,n,i,r,s,o;const a=z(V(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,h=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Ws(c&&h&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=h,this.continueUrl=null!==(r=a.continueUrl)&&void 0!==r?r:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=z(V(e)).link,n=t?z(V(t)).deep_link_id:null,i=z(V(e)).deep_link_id;return(i?z(V(i)).link:null)||i||n||t||e}(e);try{return new ea(t)}catch(e){return null}}}class ta{constructor(){this.providerId=ta.PROVIDER_ID}static credential(e,t){return Yo._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ea.parseLink(t);return Ws(n,"argument-error"),Yo._fromEmailAndCode(e,n.code,n.tenantId)}}ta.PROVIDER_ID="password",ta.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ta.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class na{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ia extends na{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ra extends ia{constructor(){super("facebook.com")}static credential(e){return Xo._fromParams({providerId:ra.PROVIDER_ID,signInMethod:ra.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ra.credentialFromTaggedObject(e)}static credentialFromError(e){return ra.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ra.credential(e.oauthAccessToken)}catch(e){return null}}}ra.FACEBOOK_SIGN_IN_METHOD="facebook.com",ra.PROVIDER_ID="facebook.com";class sa extends ia{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xo._fromParams({providerId:sa.PROVIDER_ID,signInMethod:sa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return sa.credentialFromTaggedObject(e)}static credentialFromError(e){return sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return sa.credential(t,n)}catch(e){return null}}}sa.GOOGLE_SIGN_IN_METHOD="google.com",sa.PROVIDER_ID="google.com";class oa extends ia{constructor(){super("github.com")}static credential(e){return Xo._fromParams({providerId:oa.PROVIDER_ID,signInMethod:oa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oa.credentialFromTaggedObject(e)}static credentialFromError(e){return oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return oa.credential(e.oauthAccessToken)}catch(e){return null}}}oa.GITHUB_SIGN_IN_METHOD="github.com",oa.PROVIDER_ID="github.com";class aa extends ia{constructor(){super("twitter.com")}static credential(e,t){return Xo._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return aa.credentialFromTaggedObject(e)}static credentialFromError(e){return aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return aa.credential(t,n)}catch(e){return null}}}aa.TWITTER_SIGN_IN_METHOD="twitter.com",aa.PROVIDER_ID="twitter.com";class ca{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await mo._fromIdTokenResponse(e,n,i),s=ha(n);return new ca({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=ha(n);return new ca({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function ha(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class la extends N{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,la.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new la(e,t,n,i)}}function ua(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw la._fromErrorAndOperation(e,n,t,i);throw n}))}new WeakMap;const da="__sak";class pa{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(da,"1"),this.storage.removeItem(da),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class fa extends pa{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=E();return Eo(e)||No(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Oo(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);!function(){const e=E();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||r===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fa.type="LOCAL";const ga=fa;class ma extends pa{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ma.type="SESSION";const _a=ma;class ya{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new ya(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async e=>e(t.origin,r))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function va(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}ya.receivers=[];class wa{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=va("",20);i.port1.start();const h=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(h),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(h),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function ba(){return window}function Ia(){return void 0!==ba().WorkerGlobalScope&&"function"==typeof ba().importScripts}const Ta="firebaseLocalStorageDb",Ca="firebaseLocalStorage",Ea="fbase_key";class ka{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Sa(e,t){return e.transaction([Ca],t?"readwrite":"readonly").objectStore(Ca)}function Ra(){const e=indexedDB.open(Ta,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ca,{keyPath:Ea})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ca)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ta);return new ka(e).toPromise()}(),t(await Ra()))}))}))}async function Pa(e,t,n){const i=Sa(e,!0).put({[Ea]:t,value:n});return new ka(i).toPromise()}function Aa(e,t){const n=Sa(e,!0).delete(t);return new ka(n).toPromise()}class Na{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Ra()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ia()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ya._getInstance(Ia()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new wa(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}var t}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ra();return await Pa(e,da,"1"),await Aa(e,da),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Pa(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Sa(e,!1).get(t),i=await new ka(n).toPromise();return void 0===i?null:i.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Aa(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Sa(e,!1).getAll();return new ka(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Na.type="LOCAL";const Oa=Na;Uo("rcb"),new Gs(3e4,6e4);class Da{constructor(e){this.providerId=Da.PROVIDER_ID,this.auth=Wo(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var i;const r=await n.verify();try{let s;if(Ws("string"==typeof r,e,"argument-error"),Ws("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Ws("enroll"===t.type,e,"internal-error");const n=await function(e,t){return eo(e,"POST","/v2/accounts/mfaEnrollment:start",Zs(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{Ws("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;Ws(n,e,"missing-multi-factor-info");const o=await function(e,t){return eo(e,"POST","/v2/accounts/mfaSignIn:start",Zs(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return eo(e,"POST","/v1/accounts:sendVerificationCode",Zs(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}(this.auth,e,X(t))}static credential(e,t){return Zo._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Da.credentialFromTaggedObject(t)}static credentialFromError(e){return Da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Zo._fromTokenResponse(t,n):null}}Da.PROVIDER_ID="phone",Da.PHONE_SIGN_IN_METHOD="phone";class xa extends Ko{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function La(e){return async function(e,t,n=!1){const i="signIn",r=await ua(e,i,t),s=await ca._fromIdTokenResponse(e,i,r);return n||await e._updateCurrentUser(s.user),s}(e.auth,new xa(e),e.bypassAuthState)}function Ma(e){const{auth:t,user:n}=e;return Ws(n,t,"internal-error"),async function(e,t,n=!1){const{auth:i}=e,r="reauthenticate";try{const s=await ho(e,ua(i,r,t,e),n);Ws(s.idToken,i,"internal-error");const o=co(s.idToken);Ws(o,i,"internal-error");const{sub:a}=o;return Ws(e.uid===a,i,"user-mismatch"),ca._forOperation(e,r,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&qs(i,"user-mismatch"),e}}(n,new xa(e),e.bypassAuthState)}async function Fa(e){const{auth:t,user:n}=e;return Ws(n,t,"internal-error"),async function(e,t,n=!1){const i=await ho(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ca._forOperation(e,"link",i)}(n,new xa(e),e.bypassAuthState)}class Ua{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return La;case"linkViaPopup":case"linkViaRedirect":return Fa;case"reauthViaPopup":case"reauthViaRedirect":return Ma;default:qs(this.auth,"internal-error")}}resolve(e){Vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ja=new Gs(2e3,1e4);class qa extends Ua{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,qa.currentPopupAction&&qa.currentPopupAction.cancel(),qa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ws(e,this.auth,"internal-error"),e}async onExecution(){Vs(1===this.filter.length,"Popup operations only handle one event");const e=va();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Bs(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Bs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Bs(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,ja.get())};e()}}qa.currentPopupAction=null;const Ba=new Map;class Ha extends Ua{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Ba.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return bo("pendingRedirect",e.config.apiKey,e.name)}(t),i=function(e){return yo(e._redirectPersistence)}(e);if(!await i._isAvailable())return!1;const r="true"===await i._get(n);return await i._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Ba.set(this.auth._key(),e)}return this.bypassAuthState||Ba.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Wa(e,t){Ba.set(e._key(),t)}async function za(e,t,n=!1){const i=Wo(e),r=function(e,t){return t?yo(t):(Ws(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(i,t),s=new Ha(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}class Va{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ka(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ka(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Bs(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has($a(e))}saveEventToCache(e){this.cachedEventUids.add($a(e)),this.lastProcessedEventTime=Date.now()}}function $a(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ka({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Ga=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ya=/^https?/;function Ja(e){const t=$s(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!Ya.test(n))return!1;if(Ga.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Xa=new Gs(3e4,6e4);function Qa(){const e=ba().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Za=null;function ec(e){return Za=Za||function(e){return new Promise(((t,n)=>{var i,r,s;function o(){Qa(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Qa(),n(Bs(e,"network-request-failed"))},timeout:Xa.get()})}if(null===(r=null===(i=ba().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=ba().gapi)||void 0===s?void 0:s.load)){const t=Uo("iframefcb");return ba()[t]=()=>{gapi.load?o():n(Bs(e,"network-request-failed"))},Fo(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Za=null,e}))}(e),Za}const tc=new Gs(5e3,15e3),nc={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ic=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function rc(e){const t=e.config;Ws(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Ys(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,i={apiKey:t.apiKey,appName:e.name,v:ct},r=ic.get(e.config.apiHost);r&&(i.eid=r);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${n}?${W(i).slice(1)}`}const sc={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class oc{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const ac=encodeURIComponent("fac");async function cc(e,t,n,i,r,s){Ws(e.config.authDomain,e,"auth-domain-config-required"),Ws(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:ct,eventId:r};if(t instanceof na){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",j(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof ia){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),h=c?`#${ac}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?Ys(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${W(a).slice(1)}${h}`}const hc="webStorageSupport",lc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_a,this._completeRedirectFn=za,this._overrideRedirectResult=Wa}async _openPopup(e,t,n,i){var r;return Vs(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),function(e,t,n,i=500,r=600){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},sc),{width:i.toString(),height:r.toString(),top:s,left:o}),h=E().toLowerCase();n&&(a=ko(h)?"_blank":n),Co(h)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=E()){var t;return No(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(h)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(t||"",a),new oc(null);const u=window.open(t||"",a,l);Ws(u,e,"popup-blocked");try{u.focus()}catch(e){}return new oc(u)}(e,await cc(e,t,n,$s(),i),va())}async _openRedirect(e,t,n,i){return await this._originValidation(e),r=await cc(e,t,n,$s(),i),ba().location.href=r,new Promise((()=>{}));var r}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Vs(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await ec(e),n=ba().gapi;return Ws(n,e,"internal-error"),t.open({where:document.body,url:rc(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nc,dontclear:!0},(t=>new Promise((async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=Bs(e,"network-request-failed"),s=ba().setTimeout((()=>{i(r)}),tc.get());function o(){ba().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{i(r)}))}))))}(e),n=new Va(e);return t.register("authEvent",(t=>(Ws(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hc,{type:hc},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[hc];void 0!==r&&t(!!r),qs(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return eo(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Ja(e))return}catch(e){}qs(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Oo()||Eo()||No()}};var uc="@firebase/auth",dc="0.23.2";class pc{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ws(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const fc=I("authIdTokenMaxAge")||300;let gc=null;var mc;mc="Browser",rt(new Q("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Ws(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:mc,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Do(mc)},c=new Ho(n,i,r,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(yo);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),rt(new Q("auth-internal",(e=>{return t=Wo(e.getProvider("auth").getImmediate()),new pc(t);var t}),"PRIVATE").setInstantiationMode("EXPLICIT")),ut(uc,dc,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(mc)),ut(uc,dc,"esm2017");var _c,yc="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},vc={},wc=wc||{},bc=yc||self;function Ic(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Tc(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Cc="closure_uid_"+(1e9*Math.random()>>>0),Ec=0;function kc(e,t,n){return e.call.apply(e.bind,arguments)}function Sc(e,t,n){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Rc(e,t,n){return(Rc=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?kc:Sc).apply(null,arguments)}function Pc(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Ac(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return t.prototype[n].apply(e,r)}}function Nc(){this.s=this.s,this.o=this.o}Nc.prototype.s=!1,Nc.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Cc)&&e[Cc]||(e[Cc]=++Ec))},Nc.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Oc=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Dc(e){const t=e.length;if(0<t){const n=Array(t);for(let i=0;i<t;i++)n[i]=e[i];return n}return[]}function xc(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(Ic(n)){const t=e.length||0,i=n.length||0;e.length=t+i;for(let r=0;r<i;r++)e[t+r]=n[r]}else e.push(n)}}function Lc(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Lc.prototype.h=function(){this.defaultPrevented=!0};var Mc=function(){if(!bc.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{bc.addEventListener("test",(()=>{}),t),bc.removeEventListener("test",(()=>{}),t)}catch(e){}return e}();function Fc(e){return/^[\s\xa0]*$/.test(e)}function Uc(){var e=bc.navigator;return e&&(e=e.userAgent)?e:""}function jc(e){return-1!=Uc().indexOf(e)}function qc(e){return qc[" "](e),e}qc[" "]=function(){};var Bc,Hc,Wc,zc=jc("Opera"),Vc=jc("Trident")||jc("MSIE"),$c=jc("Edge"),Kc=$c||Vc,Gc=jc("Gecko")&&!(-1!=Uc().toLowerCase().indexOf("webkit")&&!jc("Edge"))&&!(jc("Trident")||jc("MSIE"))&&!jc("Edge"),Yc=-1!=Uc().toLowerCase().indexOf("webkit")&&!jc("Edge");function Jc(){var e=bc.document;return e?e.documentMode:void 0}e:{var Xc="",Qc=(Hc=Uc(),Gc?/rv:([^\);]+)(\)|;)/.exec(Hc):$c?/Edge\/([\d\.]+)/.exec(Hc):Vc?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Hc):Yc?/WebKit\/(\S+)/.exec(Hc):zc?/(?:Version)[ \/]?(\S+)/.exec(Hc):void 0);if(Qc&&(Xc=Qc?Qc[1]:""),Vc){var Zc=Jc();if(null!=Zc&&Zc>parseFloat(Xc)){Bc=String(Zc);break e}}Bc=Xc}bc.document&&Vc?Wc=Jc()||parseInt(Bc,10)||void 0:Wc=void 0;var eh=Wc;function th(e,t){if(Lc.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Gc){e:{try{qc(t.nodeName);var r=!0;break e}catch(e){}r=!1}r||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:nh[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&th.$.h.call(this)}}Ac(th,Lc);var nh={2:"touch",3:"pen",4:"mouse"};th.prototype.h=function(){th.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ih="closure_listenable_"+(1e6*Math.random()|0),rh=0;function sh(e,t,n,i,r){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!i,this.la=r,this.key=++rh,this.fa=this.ia=!1}function oh(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function ah(e,t,n){for(const i in e)t.call(n,e[i],i,e)}function ch(e){const t={};for(const n in e)t[n]=e[n];return t}const hh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lh(e,t){let n,i;for(let t=1;t<arguments.length;t++){for(n in i=arguments[t],i)e[n]=i[n];for(let t=0;t<hh.length;t++)n=hh[t],Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}}function uh(e){this.src=e,this.g={},this.h=0}function dh(e,t){var n=t.type;if(n in e.g){var i,r=e.g[n],s=Oc(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(oh(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function ph(e,t,n,i){for(var r=0;r<e.length;++r){var s=e[r];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==i)return r}return-1}uh.prototype.add=function(e,t,n,i,r){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=ph(e,t,i,r);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new sh(t,this.src,s,!!i,r)).ia=n,e.push(t)),t};var fh="closure_lm_"+(1e6*Math.random()|0),gh={};function mh(e,t,n,i,r){if(i&&i.once)return yh(e,t,n,i,r);if(Array.isArray(t)){for(var s=0;s<t.length;s++)mh(e,t[s],n,i,r);return null}return n=Eh(n),e&&e[ih]?e.O(t,n,Tc(i)?!!i.capture:!!i,r):_h(e,t,n,!1,i,r)}function _h(e,t,n,i,r,s){if(!t)throw Error("Invalid event type");var o=Tc(r)?!!r.capture:!!r,a=Th(e);if(a||(e[fh]=a=new uh(e)),(n=a.add(t,n,i,o,s)).proxy)return n;if(i=function(){const e=Ih;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=i,i.src=e,i.listener=n,e.addEventListener)Mc||(r=o),void 0===r&&(r=!1),e.addEventListener(t.toString(),i,r);else if(e.attachEvent)e.attachEvent(bh(t.toString()),i);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(i)}return n}function yh(e,t,n,i,r){if(Array.isArray(t)){for(var s=0;s<t.length;s++)yh(e,t[s],n,i,r);return null}return n=Eh(n),e&&e[ih]?e.P(t,n,Tc(i)?!!i.capture:!!i,r):_h(e,t,n,!0,i,r)}function vh(e,t,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)vh(e,t[s],n,i,r);else i=Tc(i)?!!i.capture:!!i,n=Eh(n),e&&e[ih]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=ph(s=e.g[t],n,i,r))&&(oh(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=Th(e))&&(t=e.g[t.toString()],e=-1,t&&(e=ph(t,n,i,r)),(n=-1<e?t[e]:null)&&wh(n))}function wh(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[ih])dh(t.i,e);else{var n=e.type,i=e.proxy;t.removeEventListener?t.removeEventListener(n,i,e.capture):t.detachEvent?t.detachEvent(bh(n),i):t.addListener&&t.removeListener&&t.removeListener(i),(n=Th(t))?(dh(n,e),0==n.h&&(n.src=null,t[fh]=null)):oh(e)}}}function bh(e){return e in gh?gh[e]:gh[e]="on"+e}function Ih(e,t){if(e.fa)e=!0;else{t=new th(t,this);var n=e.listener,i=e.la||e.src;e.ia&&wh(e),e=n.call(i,t)}return e}function Th(e){return(e=e[fh])instanceof uh?e:null}var Ch="__closure_events_fn_"+(1e9*Math.random()>>>0);function Eh(e){return"function"==typeof e?e:(e[Ch]||(e[Ch]=function(t){return e.handleEvent(t)}),e[Ch])}function kh(){Nc.call(this),this.i=new uh(this),this.S=this,this.J=null}function Sh(e,t){var n,i=e.J;if(i)for(n=[];i;i=i.J)n.push(i);if(e=e.S,i=t.type||t,"string"==typeof t)t=new Lc(t,e);else if(t instanceof Lc)t.target=t.target||e;else{var r=t;lh(t=new Lc(i,e),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];r=Rh(o,i,!0,t)&&r}if(r=Rh(o=t.g=e,i,!0,t)&&r,r=Rh(o,i,!1,t)&&r,n)for(s=0;s<n.length;s++)r=Rh(o=t.g=n[s],i,!1,t)&&r}function Rh(e,t,n,i){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&dh(e.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}Ac(kh,Nc),kh.prototype[ih]=!0,kh.prototype.removeEventListener=function(e,t,n,i){vh(this,e,t,n,i)},kh.prototype.N=function(){if(kh.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],i=0;i<n.length;i++)oh(n[i]);delete t.g[e],t.h--}}this.J=null},kh.prototype.O=function(e,t,n,i){return this.i.add(String(e),t,!1,n,i)},kh.prototype.P=function(e,t,n,i){return this.i.add(String(e),t,!0,n,i)};var Ph=bc.JSON.stringify;function Ah(){var e=Fh;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Nh=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Oh),(e=>e.reset()));class Oh{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Dh(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function xh(e){bc.setTimeout((()=>{throw e}),0)}let Lh,Mh=!1,Fh=new class{constructor(){this.h=this.g=null}add(e,t){const n=Nh.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Uh=()=>{const e=bc.Promise.resolve(void 0);Lh=()=>{e.then(jh)}};var jh=()=>{for(var e;e=Ah();){try{e.h.call(e.g)}catch(e){xh(e)}var t=Nh;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Mh=!1};function qh(e,t){kh.call(this),this.h=e||1,this.g=t||bc,this.j=Rc(this.qb,this),this.l=Date.now()}function Bh(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Hh(e,t,n){if("function"==typeof e)n&&(e=Rc(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Rc(e.handleEvent,e)}return 2147483647<Number(t)?-1:bc.setTimeout(e,t||0)}function Wh(e){e.g=Hh((()=>{e.g=null,e.i&&(e.i=!1,Wh(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Ac(qh,kh),(_c=qh.prototype).ga=!1,_c.T=null,_c.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Sh(this,"tick"),this.ga&&(Bh(this),this.start()))}},_c.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},_c.N=function(){qh.$.N.call(this),Bh(this),delete this.g};class zh extends Nc{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Wh(this)}N(){super.N(),this.g&&(bc.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vh(e){Nc.call(this),this.h=e,this.g={}}Ac(Vh,Nc);var $h=[];function Kh(e,t,n,i){Array.isArray(n)||(n&&($h[0]=n.toString()),n=$h);for(var r=0;r<n.length;r++){var s=mh(t,n[r],i||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Gh(e){ah(e.g,(function(e,t){this.g.hasOwnProperty(t)&&wh(e)}),e),e.g={}}function Yh(){this.g=!0}function Jh(e,t,n,i){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var i=n[e];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Ph(n)}catch(e){return t}}(e,n)+(i?" "+i:"")}))}Vh.prototype.N=function(){Vh.$.N.call(this),Gh(this)},Vh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Yh.prototype.Ea=function(){this.g=!1},Yh.prototype.info=function(){};var Xh={},Qh=null;function Zh(){return Qh=Qh||new kh}function el(e){Lc.call(this,Xh.Ta,e)}function tl(e){const t=Zh();Sh(t,new el(t))}function nl(e,t){Lc.call(this,Xh.STAT_EVENT,e),this.stat=t}function il(e){const t=Zh();Sh(t,new nl(t,e))}function rl(e,t){Lc.call(this,Xh.Ua,e),this.size=t}function sl(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return bc.setTimeout((function(){e()}),t)}Xh.Ta="serverreachability",Ac(el,Lc),Xh.STAT_EVENT="statevent",Ac(nl,Lc),Xh.Ua="timingevent",Ac(rl,Lc);var ol={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},al={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function cl(){}function hl(e){return e.h||(e.h=e.i())}function ll(){}cl.prototype.h=null;var ul,dl={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function pl(){Lc.call(this,"d")}function fl(){Lc.call(this,"c")}function gl(){}function ml(e,t,n,i){this.l=e,this.j=t,this.m=n,this.W=i||1,this.U=new Vh(this),this.P=yl,e=Kc?125:void 0,this.V=new qh(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new _l}function _l(){this.i=null,this.g="",this.h=!1}Ac(pl,Lc),Ac(fl,Lc),Ac(gl,cl),gl.prototype.g=function(){return new XMLHttpRequest},gl.prototype.i=function(){return{}},ul=new gl;var yl=45e3,vl={},wl={};function bl(e,t,n){e.L=1,e.v=ql(Ll(t)),e.s=n,e.S=!0,Il(e,null)}function Il(e,t){e.G=Date.now(),kl(e),e.A=Ll(e.v);var n=e.A,i=e.W;Array.isArray(i)||(i=[String(i)]),Zl(n.i,"t",i),e.C=0,n=e.l.J,e.h=new _l,e.g=Zu(e.l,n?t:null,!e.s),0<e.O&&(e.M=new zh(Rc(e.Pa,e,e.g),e.O)),Kh(e.U,e.g,"readystatechange",e.nb),t=e.I?ch(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),tl(),function(e,t,n,i,r,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var h=a[c].split("=");if(1<h.length){var l=h[0];h=h[1];var u=l.split("_");o=2<=u.length&&"type"==u[1]?o+(l+"=")+h+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function Tl(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function Cl(e,t,n){let i,r=!0;for(;!e.J&&e.C<n.length;){if(i=El(e,n),i==wl){4==t&&(e.o=4,il(14),r=!1),Jh(e.j,e.m,null,"[Incomplete Response]");break}if(i==vl){e.o=4,il(15),Jh(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}Jh(e.j,e.m,i,null),Nl(e,i)}Tl(e)&&i!=wl&&i!=vl&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,il(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Vu(t),t.M=!0,il(11))):(Jh(e.j,e.m,n,"[Invalid Chunked Response]"),Al(e),Pl(e))}function El(e,t){var n=e.C,i=t.indexOf("\n",n);return-1==i?wl:(n=Number(t.substring(n,i)),isNaN(n)?vl:(i+=1)+n>t.length?wl:(t=t.slice(i,i+n),e.C=i+n,t))}function kl(e){e.Y=Date.now()+e.P,Sl(e,e.P)}function Sl(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=sl(Rc(e.lb,e),t)}function Rl(e){e.B&&(bc.clearTimeout(e.B),e.B=null)}function Pl(e){0==e.l.H||e.J||Gu(e.l,e)}function Al(e){Rl(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Bh(e.V),Gh(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Nl(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||ou(n.i,e)))if(!e.K&&ou(n.i,e)&&3==n.H){try{var i=n.Ja.g.parse(t)}catch(e){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Ku(n),Fu(n)}zu(n),il(18)}}else n.Fa=r[1],0<n.Fa-n.V&&37500>r[2]&&n.G&&0==n.A&&!n.v&&(n.v=sl(Rc(n.ib,n),6e3));if(1>=su(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else Ju(n,11)}else if((e.K||n.g==e)&&Ku(n),!Fc(t))for(r=n.Ja.g.parse(t),t=0;t<r.length;t++){let h=r[t];if(n.V=h[0],h=h[1],2==n.H)if("c"==h[0]){n.K=h[1],n.pa=h[2];const t=h[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const r=h[4];null!=r&&(n.Ga=r,n.l.info("SVER="+n.Ga));const l=h[5];null!=l&&"number"==typeof l&&0<l&&(i=1.5*l,n.L=i,n.l.info("backChannelRequestTimeoutMs_="+i)),i=n;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=i.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(au(s,s.h),s.h=null))}if(i.F){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(i.Da=e,jl(i.I,i.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((i=n).wa=Qu(i,i.J?i.pa:null,i.Y),o.K){cu(i.i,o);var a=o,c=i.L;c&&a.setTimeout(c),a.B&&(Rl(a),kl(a)),i.g=o}else Wu(i);0<n.j.length&&ju(n)}else"stop"!=h[0]&&"close"!=h[0]||Ju(n,7);else 3==n.H&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Ju(n,7):Mu(n):"noop"!=h[0]&&n.h&&n.h.Aa(h),n.A=0)}tl()}catch(e){}}function Ol(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Ic(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Ic(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const i in e)t[n++]=i;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Ic(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),r=i.length,s=0;s<r;s++)t.call(void 0,i[s],n&&n[s],e)}(_c=ml.prototype).setTimeout=function(e){this.P=e},_c.nb=function(e){e=e.target;const t=this.M;t&&3==Au(e)?t.l():this.Pa(e)},_c.Pa=function(e){try{if(e==this.g)e:{const l=Au(this.g);var t=this.g.Ia();if(this.g.da(),!(3>l)&&(3!=l||Kc||this.g&&(this.h.h||this.g.ja()||Nu(this.g)))){this.J||4!=l||7==t||tl(),Rl(this);var n=this.g.da();this.ca=n;t:if(Tl(this)){var i=Nu(this.g);e="";var r=i.length,s=4==Au(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Al(this),Pl(this);var o="";break t}this.h.i=new bc.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,e+=this.h.i.decode(i[t],{stream:s&&t==r-1});i.splice(0,r),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,i,r,s,o){e.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Fc(a)){var h=a;break t}}h=null}if(!(n=h)){this.i=!1,this.o=3,il(12),Al(this),Pl(this);break e}Jh(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Nl(this,n)}this.S?(Cl(this,l,o),Kc&&this.i&&3==l&&(Kh(this.U,this.V,"tick",this.mb),this.V.start())):(Jh(this.j,this.m,o,null),Nl(this,o)),4==l&&Al(this),this.i&&!this.J&&(4==l?Gu(this.l,this):(this.i=!1,kl(this)))}else(function(e){const t={};e=(e.g&&2<=Au(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++){if(Fc(e[i]))continue;var n=Dh(e[i]);const r=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[r]||[];t[r]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,il(12)):(this.o=0,il(13)),Al(this),Pl(this)}}}catch(e){}},_c.mb=function(){if(this.g){var e=Au(this.g),t=this.g.ja();this.C<t.length&&(Rl(this),Cl(this,e,t),this.i&&4!=e&&kl(this))}},_c.cancel=function(){this.J=!0,Al(this)},_c.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(tl(),il(17)),Al(this),this.o=2,Pl(this)):Sl(this,this.Y-e)};var Dl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xl(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof xl){this.h=e.h,Ml(this,e.j),this.s=e.s,this.g=e.g,Fl(this,e.m),this.l=e.l;var t=e.i,n=new Yl;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Ul(this,n),this.o=e.o}else e&&(t=String(e).match(Dl))?(this.h=!1,Ml(this,t[1]||"",!0),this.s=Bl(t[2]||""),this.g=Bl(t[3]||"",!0),Fl(this,t[4]),this.l=Bl(t[5]||"",!0),Ul(this,t[6]||"",!0),this.o=Bl(t[7]||"")):(this.h=!1,this.i=new Yl(null,this.h))}function Ll(e){return new xl(e)}function Ml(e,t,n){e.j=n?Bl(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Fl(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ul(e,t,n){t instanceof Yl?(e.i=t,function(e,t){t&&!e.j&&(Jl(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Xl(this,t),Zl(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Hl(t,Kl)),e.i=new Yl(t,e.h))}function jl(e,t,n){e.i.set(t,n)}function ql(e){return jl(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Bl(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Hl(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Wl),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Wl(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}xl.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Hl(t,zl,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Hl(t,zl,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Hl(n,"/"==n.charAt(0)?$l:Vl,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Hl(n,Gl)),e.join("")};var zl=/[#\/\?@]/g,Vl=/[#\?:]/g,$l=/[#\?]/g,Kl=/[#\?@]/g,Gl=/#/g;function Yl(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Jl(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var i=e[n].indexOf("="),r=null;if(0<=i){var s=e[n].substring(0,i);r=e[n].substring(i+1)}else s=e[n];t(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Xl(e,t){Jl(e),t=eu(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ql(e,t){return Jl(e),t=eu(e,t),e.g.has(t)}function Zl(e,t,n){Xl(e,t),0<n.length&&(e.i=null,e.g.set(eu(e,t),Dc(n)),e.h+=n.length)}function eu(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(_c=Yl.prototype).add=function(e,t){Jl(this),this.i=null,e=eu(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},_c.forEach=function(e,t){Jl(this),this.g.forEach((function(n,i){n.forEach((function(n){e.call(t,n,i,this)}),this)}),this)},_c.ta=function(){Jl(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let i=0;i<t.length;i++){const r=e[i];for(let e=0;e<r.length;e++)n.push(t[i])}return n},_c.Z=function(e){Jl(this);let t=[];if("string"==typeof e)Ql(this,e)&&(t=t.concat(this.g.get(eu(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},_c.set=function(e,t){return Jl(this),this.i=null,Ql(this,e=eu(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},_c.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},_c.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var i=t[n];const s=encodeURIComponent(String(i)),o=this.Z(i);for(i=0;i<o.length;i++){var r=s;""!==o[i]&&(r+="="+encodeURIComponent(String(o[i]))),e.push(r)}}return this.i=e.join("&")};var tu=class{constructor(e,t){this.g=e,this.map=t}};function nu(e){this.l=e||iu,e=bc.PerformanceNavigationTiming?0<(e=bc.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(bc.g&&bc.g.Ka&&bc.g.Ka()&&bc.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var iu=10;function ru(e){return!!e.h||!!e.g&&e.g.size>=e.j}function su(e){return e.h?1:e.g?e.g.size:0}function ou(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function au(e,t){e.g?e.g.add(t):e.h=t}function cu(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function hu(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Dc(e.i)}nu.prototype.cancel=function(){if(this.i=hu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var lu=class{stringify(e){return bc.JSON.stringify(e,void 0)}parse(e){return bc.JSON.parse(e,void 0)}};function uu(){this.g=new lu}function du(e,t,n){const i=n||"";try{Ol(e,(function(e,n){let r=e;Tc(e)&&(r=Ph(e)),t.push(i+n+"="+encodeURIComponent(r))}))}catch(e){throw t.push(i+"type="+encodeURIComponent("_badmap")),e}}function pu(e,t,n,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch(e){}}function fu(e){this.l=e.fc||null,this.j=e.ob||!1}function gu(e,t){kh.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=mu,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ac(fu,cl),fu.prototype.g=function(){return new gu(this.l,this.j)},fu.prototype.i=function(e){return function(){return e}}({}),Ac(gu,kh);var mu=0;function _u(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function yu(e){e.readyState=4,e.l=null,e.j=null,e.A=null,vu(e)}function vu(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(_c=gu.prototype).open=function(e,t){if(this.readyState!=mu)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,vu(this)},_c.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||bc).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},_c.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,yu(this)),this.readyState=mu},_c.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,vu(this)),this.g&&(this.readyState=3,vu(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==bc.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;_u(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},_c.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?yu(this):vu(this),3==this.readyState&&_u(this)}},_c.Za=function(e){this.g&&(this.response=this.responseText=e,yu(this))},_c.Ya=function(e){this.g&&(this.response=e,yu(this))},_c.ka=function(){this.g&&yu(this)},_c.setRequestHeader=function(e,t){this.v.append(e,t)},_c.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},_c.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(gu.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var wu=bc.JSON.parse;function bu(e){kh.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Iu,this.L=this.M=!1}Ac(bu,kh);var Iu="",Tu=/^https?$/i,Cu=["POST","PUT"];function Eu(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,ku(e),Ru(e)}function ku(e){e.F||(e.F=!0,Sh(e,"complete"),Sh(e,"error"))}function Su(e){if(e.h&&void 0!==wc&&(!e.C[1]||4!=Au(e)||2!=e.da()))if(e.v&&4==Au(e))Hh(e.La,0,e);else if(Sh(e,"readystatechange"),4==Au(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===o){var r=String(e.I).match(Dl)[1]||null;!r&&bc.self&&bc.self.location&&(r=bc.self.location.protocol.slice(0,-1)),i=!Tu.test(r?r.toLowerCase():"")}n=i}if(n)Sh(e,"complete"),Sh(e,"success");else{e.m=6;try{var s=2<Au(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.da()+"]",ku(e)}}finally{Ru(e)}}}function Ru(e,t){if(e.g){Pu(e);const n=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Sh(e,"ready");try{n.onreadystatechange=i}catch(e){}}}function Pu(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(bc.clearTimeout(e.A),e.A=null)}function Au(e){return e.g?e.g.readyState:0}function Nu(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Iu:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Ou(e){let t="";return ah(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Du(e,t,n){e:{for(i in n){var i=!1;break e}i=!0}i||(n=Ou(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):jl(e,t,n))}function xu(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Lu(e){this.Ga=0,this.j=[],this.l=new Yh,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=xu("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=xu("baseRetryDelayMs",5e3,e),this.hb=xu("retryDelaySeedMs",1e4,e),this.eb=xu("forwardChannelMaxRetries",2,e),this.xa=xu("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new nu(e&&e.concurrentRequestLimit),this.Ja=new uu,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Mu(e){if(Uu(e),3==e.H){var t=e.W++,n=Ll(e.I);if(jl(n,"SID",e.K),jl(n,"RID",t),jl(n,"TYPE","terminate"),Bu(e,n),(t=new ml(e,e.l,t)).L=2,t.v=ql(Ll(n)),n=!1,bc.navigator&&bc.navigator.sendBeacon)try{n=bc.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&bc.Image&&((new Image).src=t.v,n=!0),n||(t.g=Zu(t.l,null),t.g.ha(t.v)),t.G=Date.now(),kl(t)}Xu(e)}function Fu(e){e.g&&(Vu(e),e.g.cancel(),e.g=null)}function Uu(e){Fu(e),e.u&&(bc.clearTimeout(e.u),e.u=null),Ku(e),e.i.cancel(),e.m&&("number"==typeof e.m&&bc.clearTimeout(e.m),e.m=null)}function ju(e){if(!ru(e.i)&&!e.m){e.m=!0;var t=e.Na;Lh||Uh(),Mh||(Lh(),Mh=!0),Fh.add(t,e),e.C=0}}function qu(e,t){var n;n=t?t.m:e.W++;const i=Ll(e.I);jl(i,"SID",e.K),jl(i,"RID",n),jl(i,"AID",e.V),Bu(e,i),e.o&&e.s&&Du(i,e.o,e.s),n=new ml(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Hu(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),au(e.i,n),bl(n,i,t)}function Bu(e,t){e.na&&ah(e.na,(function(e,n){jl(t,n,e)})),e.h&&Ol({},(function(e,n){jl(t,n,e)}))}function Hu(e,t,n){n=Math.min(e.j.length,n);var i=e.h?Rc(e.h.Va,e.h,e):null;e:{var r=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=r[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=r[o].g;const a=r[o].map;if(n-=t,0>n)t=Math.max(0,r[o].g-100),s=!1;else try{du(a,e,"req"+n+"_")}catch(e){i&&i(a)}}if(s){i=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,i}function Wu(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Lh||Uh(),Mh||(Lh(),Mh=!0),Fh.add(t,e),e.A=0}}function zu(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=sl(Rc(e.Ma,e),Yu(e,e.A)),e.A++,0))}function Vu(e){null!=e.B&&(bc.clearTimeout(e.B),e.B=null)}function $u(e){e.g=new ml(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ll(e.wa);jl(t,"RID","rpc"),jl(t,"SID",e.K),jl(t,"AID",e.V),jl(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&jl(t,"TO",e.qa),jl(t,"TYPE","xmlhttp"),Bu(e,t),e.o&&e.s&&Du(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=ql(Ll(t)),n.s=null,n.S=!0,Il(n,e)}function Ku(e){null!=e.v&&(bc.clearTimeout(e.v),e.v=null)}function Gu(e,t){var n=null;if(e.g==t){Ku(e),Vu(e),e.g=null;var i=2}else{if(!ou(e.i,t))return;n=t.F,cu(e.i,t),i=1}if(0!=e.H)if(t.i)if(1==i){n=t.s?t.s.length:0,t=Date.now()-t.G;var r=e.C;Sh(i=Zh(),new rl(i,n)),ju(e)}else Wu(e);else if(3==(r=t.o)||0==r&&0<t.ca||!(1==i&&function(e,t){return!(su(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=sl(Rc(e.Na,e,t),Yu(e,e.C)),e.C++,0)))}(e,t)||2==i&&zu(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:Ju(e,5);break;case 4:Ju(e,10);break;case 3:Ju(e,6);break;default:Ju(e,2)}}function Yu(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Ju(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var i=Rc(e.pb,e);n||(n=new xl("//www.google.com/images/cleardot.gif"),bc.location&&"http"==bc.location.protocol||Ml(n,"https"),ql(n)),function(e,t){const n=new Yh;if(bc.Image){const i=new Image;i.onload=Pc(pu,n,i,"TestLoadImage: loaded",!0,t),i.onerror=Pc(pu,n,i,"TestLoadImage: error",!1,t),i.onabort=Pc(pu,n,i,"TestLoadImage: abort",!1,t),i.ontimeout=Pc(pu,n,i,"TestLoadImage: timeout",!1,t),bc.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=e}else t(!1)}(n.toString(),i)}else il(2);e.H=0,e.h&&e.h.za(t),Xu(e),Uu(e)}function Xu(e){if(e.H=0,e.ma=[],e.h){const t=hu(e.i);0==t.length&&0==e.j.length||(xc(e.ma,t),xc(e.ma,e.j),e.i.i.length=0,Dc(e.j),e.j.length=0),e.h.ya()}}function Qu(e,t,n){var i=n instanceof xl?Ll(n):new xl(n);if(""!=i.g)t&&(i.g=t+"."+i.g),Fl(i,i.m);else{var r=bc.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var s=new xl(null);i&&Ml(s,i),t&&(s.g=t),r&&Fl(s,r),n&&(s.l=n),i=s}return n=e.F,t=e.Da,n&&t&&jl(i,n,t),jl(i,"VER",e.ra),Bu(e,i),i}function Zu(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new bu(new fu({ob:!0})):new bu(e.va)).Oa(e.J),t}function ed(){}function td(){if(Vc&&!(10<=Number(eh)))throw Error("Environmental error: no available transport.")}function nd(e,t){kh.call(this),this.g=new Lu(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Fc(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Fc(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new sd(this)}function id(e){pl.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function rd(){fl.call(this),this.status=1}function sd(e){this.g=e}function od(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ad(e,t,n){n||(n=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(r=0;16>r;++r)i[r]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],r=e.g[2];var s=e.g[3],o=t+(s^n&(r^s))+i[0]+3614090360&4294967295;o=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=(n=(r=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(r^s))+i[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^t&(n^r))+i[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(n^s&(t^n))+i[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^r&(s^t))+i[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(r^s&(n^r))+i[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s&(n^r))+i[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^r&(t^n))+i[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(t^n&(s^t))+i[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(r^s))+i[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^r^s)+i[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^r^s)+i[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^r)+i[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^t^n)+i[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(r^s^t)+i[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^(n|~s))+i[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(r^(n|~s))+i[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(t^(s|~n))+i[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(r^(n|~s))+i[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(t^(s|~n))+i[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+i[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+r&4294967295,e.g[3]=e.g[3]+s&4294967295}function cd(e,t){this.h=t;for(var n=[],i=!0,r=e.length-1;0<=r;r--){var s=0|e[r];i&&s==t||(n[r]=s,i=!1)}this.g=n}(_c=bu.prototype).Oa=function(e){this.M=e},_c.ha=function(e,t,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():ul.g(),this.C=this.u?hl(this.u):hl(ul),this.g.onreadystatechange=Rc(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void Eu(this,e)}if(e=n||"",n=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)n.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const e of i.keys())n.set(e,i.get(e))}i=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),r=bc.FormData&&e instanceof bc.FormData,!(0<=Oc(Cu,t))||i||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Pu(this),0<this.B&&((this.L=function(e){return Vc&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Rc(this.ua,this)):this.A=Hh(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Eu(this,e)}},_c.ua=function(){void 0!==wc&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Sh(this,"timeout"),this.abort(8))},_c.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Sh(this,"complete"),Sh(this,"abort"),Ru(this))},_c.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ru(this,!0)),bu.$.N.call(this)},_c.La=function(){this.s||(this.G||this.v||this.l?Su(this):this.kb())},_c.kb=function(){Su(this)},_c.isActive=function(){return!!this.g},_c.da=function(){try{return 2<Au(this)?this.g.status:-1}catch(e){return-1}},_c.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},_c.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),wu(t)}},_c.Ia=function(){return this.m},_c.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(_c=Lu.prototype).ra=8,_c.H=1,_c.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const r=new ml(this,this.l,e);let s=this.s;if(this.U&&(s?(s=ch(s),lh(s,this.U)):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var i=this.j[n];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Hu(this,r,t),jl(n=Ll(this.I),"RID",e),jl(n,"CVER",22),this.F&&jl(n,"X-HTTP-Session-Id",this.F),Bu(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Ou(s)))+"&"+t:this.o&&Du(n,this.o,s)),au(this.i,r),this.bb&&jl(n,"TYPE","init"),this.P?(jl(n,"$req",t),jl(n,"SID","null"),r.aa=!0,bl(r,n,null)):bl(r,n,t),this.H=2}}else 3==this.H&&(e?qu(this,e):0==this.j.length||ru(this.i)||qu(this))},_c.Ma=function(){if(this.u=null,$u(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=sl(Rc(this.jb,this),e)}},_c.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,il(10),Fu(this),$u(this))},_c.ib=function(){null!=this.v&&(this.v=null,Fu(this),zu(this),il(19))},_c.pb=function(e){e?(this.l.info("Successfully pinged google.com"),il(2)):(this.l.info("Failed to ping google.com"),il(1))},_c.isActive=function(){return!!this.h&&this.h.isActive(this)},(_c=ed.prototype).Ba=function(){},_c.Aa=function(){},_c.za=function(){},_c.ya=function(){},_c.isActive=function(){return!0},_c.Va=function(){},td.prototype.g=function(e,t){return new nd(e,t)},Ac(nd,kh),nd.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;il(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Qu(e,null,e.Y),ju(e)},nd.prototype.close=function(){Mu(this.g)},nd.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Ph(e),e=n);t.j.push(new tu(t.fb++,e)),3==t.H&&ju(t)},nd.prototype.N=function(){this.g.h=null,delete this.j,Mu(this.g),delete this.g,nd.$.N.call(this)},Ac(id,pl),Ac(rd,fl),Ac(sd,ed),sd.prototype.Ba=function(){Sh(this.g,"a")},sd.prototype.Aa=function(e){Sh(this.g,new id(e))},sd.prototype.za=function(e){Sh(this.g,new rd)},sd.prototype.ya=function(){Sh(this.g,"b")},Ac(od,(function(){this.blockSize=-1})),od.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},od.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,i=this.m,r=this.h,s=0;s<t;){if(0==r)for(;s<=n;)ad(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(i[r++]=e.charCodeAt(s++),r==this.blockSize){ad(this,i),r=0;break}}else for(;s<t;)if(i[r++]=e[s++],r==this.blockSize){ad(this,i),r=0;break}}this.h=r,this.i+=t},od.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var i=0;32>i;i+=8)e[n++]=this.g[t]>>>i&255;return e};var hd={};function ld(e){return-128<=e&&128>e?function(e){var t=hd;return Object.prototype.hasOwnProperty.call(t,e)?t[e]:t[e]=function(e){return new cd([0|e],0>e?-1:0)}(e)}(e):new cd([0|e],0>e?-1:0)}function ud(e){if(isNaN(e)||!isFinite(e))return pd;if(0>e)return yd(ud(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=dd;return new cd(t,0)}var dd=4294967296,pd=ld(0),fd=ld(1),gd=ld(16777216);function md(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function _d(e){return-1==e.h}function yd(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new cd(n,~e.h).add(fd)}function vd(e,t){return e.add(yd(t))}function wd(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function bd(e,t){this.g=e,this.h=t}function Id(e,t){if(md(t))throw Error("division by zero");if(md(e))return new bd(pd,pd);if(_d(e))return t=Id(yd(e),t),new bd(yd(t.g),yd(t.h));if(_d(t))return t=Id(e,yd(t)),new bd(yd(t.g),t.h);if(30<e.g.length){if(_d(e)||_d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=fd,i=t;0>=i.X(e);)n=Td(n),i=Td(i);var r=Cd(n,1),s=Cd(i,1);for(i=Cd(i,2),n=Cd(n,2);!md(i);){var o=s.add(i);0>=o.X(e)&&(r=r.add(n),s=o),i=Cd(i,1),n=Cd(n,1)}return t=vd(e,r.R(t)),new bd(r,t)}for(r=pd;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,i-48),o=(s=ud(n)).R(t);_d(o)||0<o.X(e);)o=(s=ud(n-=i)).R(t);md(s)&&(s=fd),r=r.add(s),e=vd(e,o)}return new bd(r,e)}function Td(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.D(i)<<1|e.D(i-1)>>>31;return new cd(n,e.h)}function Cd(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,r=[],s=0;s<i;s++)r[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new cd(r,e.h)}(_c=cd.prototype).ea=function(){if(_d(this))return-yd(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var i=this.D(n);e+=(0<=i?i:dd+i)*t,t*=dd}return e},_c.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(md(this))return"0";if(_d(this))return"-"+yd(this).toString(e);for(var t=ud(Math.pow(e,6)),n=this,i="";;){var r=Id(n,t).g,s=((0<(n=vd(n,r.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(md(n=r))return s+i;for(;6>s.length;)s="0"+s;i=s+i}},_c.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},_c.X=function(e){return _d(e=vd(this,e))?-1:md(e)?0:1},_c.abs=function(){return _d(this)?yd(this):this},_c.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,r=0;r<=t;r++){var s=i+(65535&this.D(r))+(65535&e.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(e.D(r)>>>16);i=o>>>16,s&=65535,o&=65535,n[r]=o<<16|s}return new cd(n,-2147483648&n[n.length-1]?-1:0)},_c.R=function(e){if(md(this)||md(e))return pd;if(_d(this))return _d(e)?yd(this).R(yd(e)):yd(yd(this).R(e));if(_d(e))return yd(this.R(yd(e)));if(0>this.X(gd)&&0>e.X(gd))return ud(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<e.g.length;r++){var s=this.D(i)>>>16,o=65535&this.D(i),a=e.D(r)>>>16,c=65535&e.D(r);n[2*i+2*r]+=o*c,wd(n,2*i+2*r),n[2*i+2*r+1]+=s*c,wd(n,2*i+2*r+1),n[2*i+2*r+1]+=o*a,wd(n,2*i+2*r+1),n[2*i+2*r+2]+=s*a,wd(n,2*i+2*r+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new cd(n,0)},_c.gb=function(e){return Id(this,e).h},_c.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)&e.D(i);return new cd(n,this.h&e.h)},_c.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)|e.D(i);return new cd(n,this.h|e.h)},_c.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.D(i)^e.D(i);return new cd(n,this.h^e.h)},td.prototype.createWebChannel=td.prototype.g,nd.prototype.send=nd.prototype.u,nd.prototype.open=nd.prototype.m,nd.prototype.close=nd.prototype.close,ol.NO_ERROR=0,ol.TIMEOUT=8,ol.HTTP_ERROR=6,al.COMPLETE="complete",ll.EventType=dl,dl.OPEN="a",dl.CLOSE="b",dl.ERROR="c",dl.MESSAGE="d",kh.prototype.listen=kh.prototype.O,bu.prototype.listenOnce=bu.prototype.P,bu.prototype.getLastError=bu.prototype.Sa,bu.prototype.getLastErrorCode=bu.prototype.Ia,bu.prototype.getStatus=bu.prototype.da,bu.prototype.getResponseJson=bu.prototype.Wa,bu.prototype.getResponseText=bu.prototype.ja,bu.prototype.send=bu.prototype.ha,bu.prototype.setWithCredentials=bu.prototype.Oa,od.prototype.digest=od.prototype.l,od.prototype.reset=od.prototype.reset,od.prototype.update=od.prototype.j,cd.prototype.add=cd.prototype.add,cd.prototype.multiply=cd.prototype.R,cd.prototype.modulo=cd.prototype.gb,cd.prototype.compare=cd.prototype.X,cd.prototype.toNumber=cd.prototype.ea,cd.prototype.toString=cd.prototype.toString,cd.prototype.getBits=cd.prototype.D,cd.fromNumber=ud,cd.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return yd(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=ud(Math.pow(n,8)),r=pd,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=ud(Math.pow(n,o)),r=r.R(o).add(ud(a))):r=(r=r.R(i)).add(ud(a))}return r},vc.createWebChannelTransport=function(){return new td},vc.getStatEventTarget=function(){return Zh()},vc.ErrorCode=ol,vc.EventType=al,vc.Event=Xh,vc.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},vc.FetchXmlHttpFactory=fu,vc.WebChannel=ll,vc.XhrIo=bu,vc.Md5=od;var Ed=vc.Integer=cd;const kd="@firebase/firestore";class Sd{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sd.UNAUTHENTICATED=new Sd(null),Sd.GOOGLE_CREDENTIALS=new Sd("google-credentials-uid"),Sd.FIRST_PARTY=new Sd("first-party-uid"),Sd.MOCK_USER=new Sd("mock-user");let Rd="9.23.0";const Pd=new ce("@firebase/firestore");function Ad(e,...t){if(Pd.logLevel<=ie.DEBUG){const n=t.map(Od);Pd.debug(`Firestore (${Rd}): ${e}`,...n)}}function Nd(e,...t){if(Pd.logLevel<=ie.ERROR){const n=t.map(Od);Pd.error(`Firestore (${Rd}): ${e}`,...n)}}function Od(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Dd(e="Unexpected state"){const t=`FIRESTORE (${Rd}) INTERNAL ASSERTION FAILED: `+e;throw Nd(t),new Error(t)}function xd(e,t){e||Dd()}const Ld="cancelled",Md="invalid-argument",Fd="failed-precondition",Ud="unavailable";class jd extends N{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class qd{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Bd{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Hd{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Sd.UNAUTHENTICATED)))}shutdown(){}}class Wd{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class zd{constructor(e){this.t=e,this.currentUser=Sd.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const i=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let r=new qd;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new qd,e.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const t=r;e.enqueueRetryable((async()=>{await t.promise,await i(this.currentUser)}))},o=e=>{Ad("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Ad("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new qd)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Ad("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(xd("string"==typeof t.accessToken),new Bd(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return xd(null===e||"string"==typeof e),new Sd(e)}}class Vd{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=Sd.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class $d{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new Vd(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(Sd.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Kd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Gd{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&Ad("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,Ad("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const i=e=>{Ad("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit((e=>i(e))),setTimeout((()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?i(e):Ad("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(xd("string"==typeof e.token),this.T=e.token,new Kd(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Yd(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class Jd{static A(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Yd(40);for(let i=0;i<n.length;++i)t.length<20&&n[i]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return t}}function Xd(e,t){return e<t?-1:e>t?1:0}class Qd{constructor(e,t,n){void 0===t?t=0:t>e.length&&Dd(),void 0===n?n=e.length-t:n>e.length-t&&Dd(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Qd.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qd?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const n=e.get(i),r=t.get(i);if(n<r)return-1;if(n>r)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Zd extends Qd{construct(e,t,n){return new Zd(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new jd(Md,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Zd(t)}static emptyPath(){return new Zd([])}}class ep{constructor(e){this.path=e}static fromPath(e){return new ep(Zd.fromString(e))}static fromName(e){return new ep(Zd.fromString(e).popFirst(5))}static empty(){return new ep(Zd.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Zd.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Zd.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ep(new Zd(e.slice()))}}function tp(e){return"IndexedDbTransactionError"===e.name}class np{constructor(e,t){this.comparator=e,this.root=t||rp.EMPTY}insert(e,t){return new np(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rp.BLACK,null,null))}remove(e){return new np(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rp.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ip(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ip(this.root,e,this.comparator,!1)}getReverseIterator(){return new ip(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ip(this.root,e,this.comparator,!0)}}class ip{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?n(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rp{constructor(e,t,n,i,r){this.key=e,this.value=t,this.color=null!=n?n:rp.RED,this.left=null!=i?i:rp.EMPTY,this.right=null!=r?r:rp.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,r){return new rp(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const r=n(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return rp.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return rp.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,rp.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,rp.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Dd();if(this.right.isRed())throw Dd();const e=this.left.check();if(e!==this.right.check())throw Dd();return e+(this.isRed()?0:1)}}rp.EMPTY=null,rp.RED=!0,rp.BLACK=!1,rp.EMPTY=new class{constructor(){this.size=0}get key(){throw Dd()}get value(){throw Dd()}get color(){throw Dd()}get left(){throw Dd()}get right(){throw Dd()}copy(e,t,n,i,r){return this}insert(e,t,n){return new rp(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sp{constructor(e){this.comparator=e,this.data=new np(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new op(this.data.getIterator())}getIteratorFrom(e){return new op(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof sp))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new sp(this.comparator);return t.data=e,t}}class op{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ap extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class cp{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new ap("Invalid base64 string: "+e):e}}(e);return new cp(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new cp(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xd(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}function hp(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}cp.EMPTY_BYTE_STRING=new cp(""),new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);class lp{constructor(e,t,n,i,r,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class up{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new up("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof up&&e.projectId===this.projectId&&e.database===this.database}}var dp,pp;new np(ep.comparator),new np(ep.comparator),new np(ep.comparator),new sp(ep.comparator),new sp(Xd),(pp=dp||(dp={}))[pp.OK=0]="OK",pp[pp.CANCELLED=1]="CANCELLED",pp[pp.UNKNOWN=2]="UNKNOWN",pp[pp.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pp[pp.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pp[pp.NOT_FOUND=5]="NOT_FOUND",pp[pp.ALREADY_EXISTS=6]="ALREADY_EXISTS",pp[pp.PERMISSION_DENIED=7]="PERMISSION_DENIED",pp[pp.UNAUTHENTICATED=16]="UNAUTHENTICATED",pp[pp.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pp[pp.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pp[pp.ABORTED=10]="ABORTED",pp[pp.OUT_OF_RANGE=11]="OUT_OF_RANGE",pp[pp.UNIMPLEMENTED=12]="UNIMPLEMENTED",pp[pp.INTERNAL=13]="INTERNAL",pp[pp.UNAVAILABLE=14]="UNAVAILABLE",pp[pp.DATA_LOSS=15]="DATA_LOSS",new Ed([4294967295,4294967295],0),Error;class fp{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(hp(e.integerValue));else if("doubleValue"in e){const n=hp(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),function(e){return 0===e&&1/e==-1/0}(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(function(e){return"string"==typeof e?cp.fromBase64String(e):cp.fromUint8Array(e)}(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?function(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):Dd()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const e of Object.keys(n))this.Te(e,t),this.me(n[e],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const e of n)this.me(e,t)}ve(e,t){this.ye(t,37),ep.fromName(e).path.forEach((e=>{this.ye(t,60),this.be(e,t)}))}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}fp.Ve=new fp,new Uint8Array(0);class gp{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new gp(e,gp.DEFAULT_COLLECTION_PERCENTILE,gp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function mp(){return"undefined"!=typeof document?document:null}gp.DEFAULT_COLLECTION_PERCENTILE=10,gp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gp.DEFAULT=new gp(41943040,gp.DEFAULT_COLLECTION_PERCENTILE,gp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gp.DISABLED=new gp(-1,0,0);class _p{constructor(e,t,n=1e3,i=1.5,r=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=r,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&Ad("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,(()=>(this.Co=Date.now(),e()))),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class yp{constructor(e,t,n,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new qd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,i,r){const s=Date.now()+n,o=new yp(e,t,s,i,r);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new jd(Ld,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class vp{constructor(e,t,n,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Sd.UNAUTHENTICATED,this.clientId=Jd.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Ad("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Ad("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new jd(Fd,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=function(e,t){if(Nd("AsyncQueue",`${t}: ${e}`),tp(e))return new jd(Ud,`${t}: ${e}`);throw e}(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}function wp(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const bp=new Map;function Ip(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new jd(Md,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Dd()}(e);throw new jd(Md,`Expected type '${t.name}', but it was: ${n}`)}}return e}class Tp{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new jd(Md,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new jd(Md,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,i){if(!0===t&&!0===i)throw new jd(Md,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wp(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new jd(Md,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new jd(Md,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new jd(Md,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class Cp{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new jd(Fd,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new jd(Fd,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tp(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Hd;switch(e.type){case"firstParty":return new $d(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new jd(Md,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=bp.get(e);t&&(Ad("ComponentProvider","Removing Datastore"),bp.delete(e),t.terminate())}(this),Promise.resolve()}}class Ep{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new _p(this,"async_queue_retry"),this.Xc=()=>{const e=mp();e&&Ad("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=mp();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=mp();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise((()=>{}));const t=new qd;return this.ta((()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qc.push(e),this.ea())))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!tp(e))throw e;Ad("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No((()=>this.ea()))}}ta(e){const t=this.Gc.then((()=>(this.Hc=!0,e().catch((e=>{this.Wc=e,this.Hc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Nd("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Hc=!1,e))))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=yp.createAndSchedule(this,e,t,n,(e=>this.na(e)));return this.zc.push(i),i}Zc(){this.Wc&&Dd()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then((()=>{this.zc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()}))}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}class kp extends Cp{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Ep,this._persistenceKey=(null==i?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||function(e){var t,n,i;const r=e._freezeSettings(),s=function(e,t,n,i){return new lp(e,t,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,wp(i.experimentalLongPollingOptions),i.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,r);e._firestoreClient=new vp(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=r.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(i=r.cache)||void 0===i?void 0:i._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.cache.kind,_offline:r.cache._offlineComponentProvider,_online:r.cache._onlineComponentProvider})}(this),this._firestoreClient.terminate()}}let Sp,Rp;new RegExp("[~\\*/\\[\\]]"),function(e,t=!0){!function(e){Rd=e}(ct),rt(new Q("firestore",((e,{instanceIdentifier:n,options:i})=>{const r=e.getProvider("app").getImmediate(),s=new kp(new zd(e.getProvider("auth-internal")),new Gd(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new jd(Md,'"projectId" not provided in firebase.initializeApp.');return new up(e.options.projectId,t)}(r,n),r);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),ut(kd,"3.13.0",e),ut(kd,"3.13.0","esm2017")}();const Pp=new WeakMap,Ap=new WeakMap,Np=new WeakMap,Op=new WeakMap,Dp=new WeakMap;let xp={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ap.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Np.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Mp(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Lp(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Rp||(Rp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Fp(this),e),Mp(Pp.get(this))}:function(...e){return Mp(t.apply(Fp(this),e))}:function(e,...n){const i=t.call(Fp(this),e,...n);return Np.set(i,e.sort?e.sort():[e]),Mp(i)}:(e instanceof IDBTransaction&&function(e){if(Ap.has(e))return;const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),i()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));Ap.set(e,t)}(e),n=e,(Sp||(Sp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,xp):e);var t,n}function Mp(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const i=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(Mp(e.result)),i()},s=()=>{n(e.error),i()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Pp.set(t,e)})).catch((()=>{})),Dp.set(t,e),t}(e);if(Op.has(e))return Op.get(e);const t=Lp(e);return t!==e&&(Op.set(e,t),Dp.set(t,e)),t}const Fp=e=>Dp.get(e),Up=["get","getKey","getAll","getAllKeys","count"],jp=["put","add","delete","clear"],qp=new Map;function Bp(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(qp.get(t))return qp.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,r=jp.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!Up.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return qp.set(t,s),s}xp=(e=>({...e,get:(t,n,i)=>Bp(t,n)||e.get(t,n,i),has:(t,n)=>!!Bp(t,n)||e.has(t,n)}))(xp);const Hp="@firebase/installations",Wp="0.6.4",zp=`w:${Wp}`,Vp="FIS_v2",$p=new O("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Kp(e){return e instanceof N&&e.code.includes("request-failed")}function Gp({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function Yp(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Jp(e,t){const n=(await t.json()).error;return $p.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Xp({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Qp(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Zp(e){return new Promise((t=>{setTimeout(t,e)}))}const ef=/^[cdef][\w-]{21}$/;function tf(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){var t;return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return ef.test(t)?t:""}catch(e){return""}}function nf(e){return`${e.appName}!${e.appId}`}const rf=new Map;function sf(e,t){const n=nf(e);of(n,t),function(e,t){const n=(!af&&"BroadcastChannel"in self&&(af=new BroadcastChannel("[Firebase] FID Change"),af.onmessage=e=>{of(e.data.key,e.data.fid)}),af);n&&n.postMessage({key:e,fid:t}),0===rf.size&&af&&(af.close(),af=null)}(n,t)}function of(e,t){const n=rf.get(e);if(n)for(const e of n)e(t)}let af=null;const cf="firebase-installations-store";let hf=null;function lf(){return hf||(hf=function(e,t,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(e,t),a=Mp(o);return i&&o.addEventListener("upgradeneeded",(e=>{i(Mp(o.result),e.oldVersion,e.newVersion,Mp(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(cf)}})),hf}async function uf(e,t){const n=nf(e),i=(await lf()).transaction(cf,"readwrite"),r=i.objectStore(cf),s=await r.get(n);return await r.put(t,n),await i.done,s&&s.fid===t.fid||sf(e,t.fid),t}async function df(e){const t=nf(e),n=(await lf()).transaction(cf,"readwrite");await n.objectStore(cf).delete(t),await n.done}async function pf(e,t){const n=nf(e),i=(await lf()).transaction(cf,"readwrite"),r=i.objectStore(cf),s=await r.get(n),o=t(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||sf(e,o.fid),o}async function ff(e){let t;const n=await pf(e.appConfig,(n=>{const i=function(e){return _f(e||{fid:tf(),registrationStatus:0})}(n),r=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject($p.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const i=Gp(e),r=Xp(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={fid:n,authVersion:Vp,appId:e.appId,sdkVersion:zp},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Qp((()=>fetch(i,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:Yp(e.authToken)}}throw await Jp("Create Installation",c)}(e,t);return uf(e.appConfig,n)}catch(n){throw Kp(n)&&409===n.customData.serverCode?await df(e.appConfig):await uf(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:i}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:gf(e)}:{installationEntry:t}}(e,i);return t=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function gf(e){let t=await mf(e.appConfig);for(;1===t.registrationStatus;)await Zp(100),t=await mf(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await ff(e);return n||t}return t}function mf(e){return pf(e,(e=>{if(!e)throw $p.create("installation-not-found");return _f(e)}))}function _f(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function yf({appConfig:e,heartbeatServiceProvider:t},n){const i=function(e,{fid:t}){return`${Gp(e)}/${t}/authTokens:generate`}(e,n),r=function(e,{refreshToken:t}){const n=Xp(e);return n.append("Authorization",function(e){return`${Vp} ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&r.append("x-firebase-client",e)}const o={installation:{sdkVersion:zp,appId:e.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await Qp((()=>fetch(i,a)));if(c.ok)return Yp(await c.json());throw await Jp("Generate Auth Token",c)}async function vf(e,t=!1){let n;const i=await pf(e.appConfig,(i=>{if(!bf(i))throw $p.create("not-registered");const r=i.authToken;if(!t&&(2===(s=r).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(s)))return i;var s;if(1===r.requestStatus)return n=async function(e,t){let n=await wf(e.appConfig);for(;1===n.authToken.requestStatus;)await Zp(100),n=await wf(e.appConfig);const i=n.authToken;return 0===i.requestStatus?vf(e,t):i}(e,t),i;{if(!navigator.onLine)throw $p.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(i);return n=async function(e,t){try{const n=await yf(e,t),i=Object.assign(Object.assign({},t),{authToken:n});return await uf(e.appConfig,i),n}catch(n){if(!Kp(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await uf(e.appConfig,n)}else await df(e.appConfig);throw n}}(e,t),t}}));return n?await n:i.authToken}function wf(e){return pf(e,(e=>{if(!bf(e))throw $p.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function bf(e){return void 0!==e&&2===e.registrationStatus}function If(e){return $p.create("missing-app-config-values",{valueName:e})}const Tf="installations";rt(new Q(Tf,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw If("App Configuration");if(!e.name)throw If("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw If(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:st(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),rt(new Q("installations-internal",(e=>{const t=st(e.getProvider("app").getImmediate(),Tf).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:i}=await ff(t);return i?i.catch(console.error):vf(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await ff(e);t&&await t}(n),(await vf(n,t)).token}(t,e)}}),"PRIVATE")),ut(Hp,Wp),ut(Hp,Wp,"esm2017");const Cf="analytics",Ef="https://www.googletagmanager.com/gtag/js",kf=new ce("@firebase/analytics"),Sf=new O("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function Rf(e){if(!e.startsWith(Ef)){const t=Sf.create("invalid-gtag-resource",{gtagURL:e});return kf.warn(t.message),""}return e}function Pf(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const Af=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Nf(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Of(e,t=Af,n){const{appId:i,apiKey:r,measurementId:s}=e.options;if(!i)throw Sf.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Sf.create("no-api-key")}const o=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new xf;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Df({appId:i,apiKey:r,measurementId:s},o,a,t)}async function Df(e,{throttleEndTimeMillis:t,backoffCount:n},i,r=Af){var s;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,i)=>{const r=Math.max(t-Date.now(),0),s=setTimeout(n,r);e.addEventListener((()=>{clearTimeout(s),i(Sf.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(i,t)}catch(e){if(a)return kf.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:i}=e,r={method:"GET",headers:Nf(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw Sf.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return r.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof N&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(r.deleteThrottleMetadata(o),a)return kf.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const h=503===Number(null===(s=null==c?void 0:c.customData)||void 0===s?void 0:s.httpStatus)?J(n,r.intervalMillis,30):J(n,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return r.setThrottleMetadata(o,l),kf.debug(`Calling attemptFetch again in ${h} millis`),Df(e,l,i,r)}}class xf{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Lf,Mf;async function Ff(e,t,n,i,r,s,o){var a;const c=Of(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&kf.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>kf.error(e))),t.push(c);const h=async function(){if(!P())return kf.warn(Sf.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await A()}catch(e){return kf.warn(Sf.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?i.getId():void 0)),[l,u]=await Promise.all([c,h]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(Ef)&&n.src.includes(e))return n;return null})(s)||function(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",t)),n}(0,{createScriptURL:Rf}),i=document.createElement("script"),r=`${Ef}?l=${e}&id=${t}`;i.src=n?null==n?void 0:n.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,l.measurementId),Mf&&(r("consent","default",Mf),Mf=void 0),r("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=u&&(d.firebase_id=u),r("config",l.measurementId,d),Lf&&(r("set",Lf),Lf=void 0),l.measurementId}class Uf{constructor(e){this.app=e}_delete(){return delete jf[this.app.options.appId],Promise.resolve()}}let jf={},qf=[];const Bf={};let Hf,Wf,zf="dataLayer",Vf=!1;function $f(e,t,n){!function(){const e=[];if(S()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=Sf.create("invalid-analytics-context",{errorInfo:t});kf.warn(n.message)}}();const i=e.options.appId;if(!i)throw Sf.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Sf.create("no-api-key");kf.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=jf[i])throw Sf.create("already-exists",{id:i});if(!Vf){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(zf);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,i,r){let s=function(...e){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function(e,t,n,i){return async function(r,...s){try{if("event"===r){const[i,r]=s;await async function(e,t,n,i,r){try{let s=[];if(r&&r.send_to){let e=r.send_to;Array.isArray(e)||(e=[e]);const i=await Pf(n);for(const n of e){const e=i.find((e=>e.measurementId===n)),r=e&&t[e.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",i,r||{})}catch(e){kf.error(e)}}(e,t,n,i,r)}else if("config"===r){const[r,o]=s;await async function(e,t,n,i,r,s){const o=i[r];try{if(o)await t[o];else{const e=(await Pf(n)).find((e=>e.measurementId===r));e&&await t[e.appId]}}catch(e){kf.error(e)}e("config",r,s)}(e,t,n,i,r,o)}else if("consent"===r){const[t]=s;e("consent","update",t)}else if("get"===r){const[t,n,i]=s;e("get",t,n,i)}else if("set"===r){const[t]=s;e("set",t)}else e(r,...s)}catch(e){kf.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window[r]}}(jf,qf,Bf,zf,"gtag");Wf=e,Hf=t,Vf=!0}return jf[i]=Ff(e,qf,Bf,t,Hf,zf,n),new Uf(e)}const Kf="@firebase/analytics",Gf="0.10.0";rt(new Q(Cf,((e,{options:t})=>$f(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),rt(new Q("analytics-internal",(function(e){try{const t=e.getProvider(Cf).getImmediate();return{logEvent:(e,n,i)=>function(e,t,n,i){e=X(e),async function(e,t,n,i,r){if(r&&r.global)e("event",n,i);else{const r=await t;e("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(Wf,jf[e.app.options.appId],t,n,i).catch((e=>kf.error(e)))}(t,e,n,i)}}catch(e){throw Sf.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),ut(Kf,Gf),ut(Kf,Gf,"esm2017");var Yf=ht({apiKey:"AIzaSyB3Hu6Nn0b3_30nqoN9kMlE3oaa04VijTI",authDomain:"call-of-jacob.firebaseapp.com",projectId:"call-of-jacob",storageBucket:"call-of-jacob.firebasestorage.app",messagingSenderId:"354335345072",appId:"1:354335345072:web:a77085f10df89f92d4ee75",measurementId:"G-6ZLPL9EHDM",databaseURL:"https://call-of-jacob-default-rtdb.firebaseio.com"});(function(e=lt()){const t=st(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=st(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(B(n.getOptions(),null!=t?t:{}))return e;qs(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:lc,persistence:[Oa,ga,_a]}),i=I("authTokenSyncURL");if(i){const e=(r=i,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>fc)return;const i=null==t?void 0:t.token;gc!==i&&(gc=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});!function(e,t,n){X(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t){X(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var r;const s=v("auth");s&&function(e,t,n){const i=Wo(e);Ws(i._canInitEmulator,i,"emulator-config-failed"),Ws(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=Vo(t),{host:o,port:a}=function(e){const t=Vo(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:$o(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:$o(t)}}}(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`)})(Yf),function(e){const t="string"==typeof e?e:"(default)",n=st("object"==typeof e?e:lt(),"firestore").getImmediate({identifier:t});if(!n._initialized){const e=w("firestore");e&&function(e,t,n,i={}){var r;const s=(e=Ip(e,Cp))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&function(e,...t){if(Pd.logLevel<=ie.WARN){const n=t.map(Od);Pd.warn(`Firestore (${Rd}): ${e}`,...n)}}("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=Sd.MOCK_USER;else{t=C(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);const s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new jd(Md,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Sd(s)}e._authCredentials=new Wd(new Bd(t,n))}}(n,...e)}}(Yf),function(e=lt(),t){const n=st(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=w("database");e&&function(e,t,n,i={}){(e=X(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Ut("Cannot call useEmulator() after instance has already been initialized.");const r=e._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Ut('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new nn(nn.OWNER);else if(i.mockUserToken){const t="string"==typeof i.mockUserToken?i.mockUserToken:C(i.mockUserToken,e.app.options.projectId);s=new nn(t)}!function(e,t,n,i){e.repoInfo_=new hn(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),i&&(e.authTokenProvider_=i)}(r,t,n,s)}(n,...e)}}(Yf),function(e=lt()){const t=st(e=X(e),Cf);t.isInitialized()?t.getImmediate():function(e,t={}){const n=st(e,Cf);if(n.isInitialized()){const e=n.getImmediate();if(B(t,n.getOptions()))return e;throw Sf.create("already-initialized")}n.initialize({options:t})}(e)}(Yf);const Jf=new(function(){return(0,s.A)((function e(){(0,r.A)(this,e),this.currentMatch=null,this.onMatchFound=null}),[{key:"startMatchmaking",value:(e=(0,i.A)(a().mark((function e(){var t,n=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:{},console.log("Matchmaking started with options:",t);case 2:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})},{key:"cancelMatchmaking",value:function(){console.log("Matchmaking cancelled")}},{key:"joinMatch",value:function(e){this.currentMatch=e,this.onMatchFound&&this.onMatchFound(e)}}]);var e}())},671:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var i=n(29),r=n(212);const s=new(function(){return(0,r.A)((function e(){(0,i.A)(this,e),this.lastProcessedInput=0,this.pendingInputs=[]}),[{key:"applyInput",value:function(e){console.log("Applying input:",e)}},{key:"getInterpolatedState",value:function(e){return{}}}])}())},314:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(29),r=n(212);const s=new(function(){return(0,r.A)((function e(){(0,i.A)(this,e),this.logLevels={ERROR:0,WARN:1,INFO:2,DEBUG:3},this.currentLevel=this.logLevels.INFO}),[{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.currentLevel>=this.logLevels.ERROR&&(console.error("[ERROR] ".concat(e),t),ErrorTracker.trackError(t||new Error(e)))}},{key:"warn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.currentLevel>=this.logLevels.WARN&&console.warn("[WARN] ".concat(e),t)}},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.currentLevel>=this.logLevels.INFO&&console.info("[INFO] ".concat(e),t)}},{key:"debug",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.currentLevel>=this.logLevels.DEBUG&&console.debug("[DEBUG] ".concat(e),t)}},{key:"setLevel",value:function(e){this.currentLevel=e}}])}())},633:(e,t,n)=>{var i=n(738).default;function r(){"use strict";e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},s=Object.prototype,o=s.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},c="function"==typeof Symbol?Symbol:{},h=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",u=c.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(t){d=function(e,t,n){return e[t]=n}}function p(e,t,n,i){var r=t&&t.prototype instanceof w?t:w,s=Object.create(r.prototype),o=new D(i||[]);return a(s,"_invoke",{value:P(e,n,o)}),s}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=p;var g="suspendedStart",m="suspendedYield",_="executing",y="completed",v={};function w(){}function b(){}function I(){}var T={};d(T,h,(function(){return this}));var C=Object.getPrototypeOf,E=C&&C(C(x([])));E&&E!==s&&o.call(E,h)&&(T=E);var k=I.prototype=w.prototype=Object.create(T);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(r,s,a,c){var h=f(e[r],e,s);if("throw"!==h.type){var l=h.arg,u=l.value;return u&&"object"==i(u)&&o.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(h.arg)}var r;a(this,"_invoke",{value:function(e,i){function s(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(s,s):s()}})}function P(e,n,i){var r=g;return function(s,o){if(r===_)throw Error("Generator is already running");if(r===y){if("throw"===s)throw o;return{value:t,done:!0}}for(i.method=s,i.arg=o;;){var a=i.delegate;if(a){var c=A(a,i);if(c){if(c===v)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===g)throw r=y,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=_;var h=f(e,n,i);if("normal"===h.type){if(r=i.done?y:m,h.arg===v)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(r=y,i.method="throw",i.arg=h.arg)}}}function A(e,n){var i=n.method,r=e.iterator[i];if(r===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),v;var s=f(r,e.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,v;var o=s.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function x(e){if(e||""===e){var n=e[h];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,s=function n(){for(;++r<e.length;)if(o.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(i(e)+" is not iterable")}return b.prototype=I,a(k,"constructor",{value:I,configurable:!0}),a(I,"constructor",{value:b,configurable:!0}),b.displayName=d(I,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,d(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},n.awrap=function(e){return{__await:e}},S(R.prototype),d(R.prototype,l,(function(){return this})),n.AsyncIterator=R,n.async=function(e,t,i,r,s){void 0===s&&(s=Promise);var o=new R(p(e,t,i,r),s);return n.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(k),d(k,u,"Generator"),d(k,h,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},n.values=x,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(i,r){return a.type="throw",a.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=o.call(s,"catchLoc"),h=o.call(s,"finallyLoc");if(c&&h){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;O(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:x(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),v}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},756:(e,t,n)=>{var i=n(633)();e.exports=i;try{regeneratorRuntime=i}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},467:(e,t,n)=>{"use strict";function i(e,t,n,i,r,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var o=e.apply(t,n);function a(e){i(o,r,s,a,c,"next",e)}function c(e){i(o,r,s,a,c,"throw",e)}a(void 0)}))}}n.d(t,{A:()=>r})},29:(e,t,n)=>{"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{A:()=>i})},212:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function o(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{A:()=>o})}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var t=n(467),i=n(29),r=n(212),s=n(756),o=n.n(s),a=(n(77),n(671),n(362),n(314),function(){return(0,r.A)((function e(){(0,i.A)(this,e),this.matchmaking=null,this.stateReconciliation=null,this.lastUpdate=performance.now(),this.isRunning=!1,this.assetsLoaded=!1}),[{key:"init",value:(a=(0,t.A)(o().mark((function t(){var i,r,s,a,c,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([Promise.resolve().then(n.bind(n,77)),Promise.resolve().then(n.bind(n,671)),Promise.resolve().then(n.bind(n,362))]);case 3:return r=t.sent,l=3,s=function(e){if(Array.isArray(e))return e}(o=r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s,o,a=[],c=!0,h=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(a.push(i.value),a.length!==t);c=!0);}catch(e){h=!0,r=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(h)throw r}}return a}}(o,l)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}(o,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=s[0].default,c=s[1].default,h=s[2].default,this.matchmaking=a,this.stateReconciliation=c,t.next=12,this.loadEssentialAssets(h);case 12:this.assetsLoaded=!0,null===(i=document.getElementById("loading-screen"))||void 0===i||i.classList.add("hidden"),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("Failed to initialize game:",t.t0),document.querySelector(".loading-text").textContent="Failed to load game assets";case 20:case"end":return t.stop()}var o,l}),t,this,[[0,16]])}))),function(){return a.apply(this,arguments)})},{key:"loadEssentialAssets",value:(s=(0,t.A)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[{path:"/assets/textures/default.png",type:"texture"}],e.next=3,t.preloadAssets(n);case 3:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"start",value:function(){this.isRunning=!0,this.gameLoop()}},{key:"update",value:function(e){if(this.stateReconciliation){var t=this.getPlayerInput();this.stateReconciliation.applyInput(t)}}},{key:"getPlayerInput",value:function(){return{forward:!1,backward:!1,left:!1,right:!1,jump:!1,shoot:!1,aim:!1,reload:!1,mouseDelta:{x:0,y:0}}}},{key:"gameLoop",value:function(){var e=this;if(this.isRunning){var t=performance.now(),n=(t-this.lastUpdate)/1e3;this.lastUpdate=t,this.update(n),this.render(),requestAnimationFrame((function(){return e.gameLoop()}))}}},{key:"render",value:function(){}}]);var s,a}());document.addEventListener("DOMContentLoaded",(function(){if(document.getElementById("game-container")){var e=new a;window.game=e,e.start()}else console.error("Game container not found!")}))})()})();